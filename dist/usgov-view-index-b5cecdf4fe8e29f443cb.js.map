{"version":3,"sources":["webpack:///./src/applets/usgov/views/index-view.coffee","webpack:///./node_modules/tbirds/src/views/paginate-bar.coffee"],"names":["$","Backbone","ItemCollectionView","ItemView","ListView","Marionette","MessageChannel","PaginateBar","itemTemplate","listTemplate","marked","navigateTemplate","tc","view_template","boundMethodCheck","instance","Constructor","Error","__webpack_require__","default","Radio","channel","renderable","model","li","span","a","href","person","name","div","text","ul","button","type","i","NavigateBox","View","keydownHandler","this","bind","[object Object]","collection","state","currentPage","firstPage","_onFirstPage","ui","prevButton","hide","show","lastPage","nextButton","totalRecords","command","getAnotherPage","event","key","ref","results","value","keyCommands","keyCode","handleKeyCommand","updateNavButtons","on","keydown","off","unbind","direction","onLastPage","getPreviousPage","getNextPage","template","events","click @ui.prevButton","click @ui.nextButton","prev","next","preventDefault","request","item","link","click @ui.link","CollectionView","childView","view","showChildView","setKeyHandler","header","itemList","paginateBar","regions","navBox","raw","appName","MainView","templateContext","module","exports","teacup__WEBPACK_IMPORTED_MODULE_3__","teacup__WEBPACK_IMPORTED_MODULE_3___default","n","backbone__WEBPACK_IMPORTED_MODULE_1___default","__webpack_exports__","PaginationView","backbone_marionette__WEBPACK_IMPORTED_MODULE_2___default","pageNumber","jquery__WEBPACK_IMPORTED_MODULE_0___default","target","attr","getPage","Number","cp","nextItem","prevItem","parent","hasClass","addClass","removeClass","numberedPage","onFirstPage","resp","getOption","onRenderHandleKeys","onBeforeDestroyHandleKeys","keycommands","tagName","className","p","ref1","Collection","totalPages","data","click @ui.numberedPage"],"mappings":"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","file":"usgov-view-index-b5cecdf4fe8e29f443cb.js","sourcesContent":["$ = require 'jquery'\nBackbone = require 'backbone'\nMarionette = require 'backbone.marionette'\ntc = require 'teacup'\nmarked = require 'marked'\n\nnavigate_to_url = require('tbirds/util/navigate-to-url').default\nPaginateBar = require('tbirds/views/paginate-bar').default\n\n\nMessageChannel = Backbone.Radio.channel 'messages'\n\nitemTemplate = tc.renderable (model) ->\n  itemBtn = '.btn.btn-sm'\n  tc.li '.list-group-item.bg-body-d5', ->\n    tc.span ->\n      tc.a href:\"\", model.person.name\n\nlistTemplate = tc.renderable ->\n  tc.div '.listview-header', ->\n    tc.text \"US Gov Roles\"\n  tc.div '.paginate-bar'\n  tc.div '.navbox'\n  tc.ul \".list-group\"\n\n\nnavigateTemplate = tc.renderable ->\n  tc.div '.btn-group', ->\n    tc.button '.prev.btn.btn-secondary', type:'button', ->\n      tc.i '.fa.fa-arrow-left'\n    tc.button '.next.btn.btn-secondary', type:'button', ->\n      tc.i '.fa.fa-arrow-right'\n    \nclass NavigateBox extends Marionette.View\n  template: navigateTemplate\n  ui:\n    prevButton: '.prev'\n    nextButton: '.next'\n  events:\n    'click @ui.prevButton': 'getPreviousPage'\n    'click @ui.nextButton': 'getNextPage'\n  templateContext: ->\n    collection: @collection\n  _onFirstPage: ->\n    state = @collection.state\n    diff = state.currentPage - state.firstPage\n    return diff is 0\n    \n  updateNavButtons: ->\n    if @_onFirstPage()\n      @ui.prevButton.hide()\n    else\n      @ui.prevButton.show()\n    currentPage = @collection.state.currentPage\n    if currentPage != @collection.state.lastPage\n      @ui.nextButton.show()\n    else\n      @ui.nextButton.hide()\n    if @collection.state.totalRecords is 0\n      @ui.prevButton.hide()\n      @ui.nextButton.hide()\n\n  keyCommands:\n    prev: 37\n    next: 39\n  handleKeyCommand: (command) ->\n    if command in ['prev', 'next']\n      @getAnotherPage command\n  keydownHandler: (event) =>\n    for key, value of @keyCommands\n      if event.keyCode is value\n        @handleKeyCommand key\n\n  onRender: ->\n    @updateNavButtons()\n    @collection.on 'pageable:state:change', =>\n      @updateNavButtons()\n    $('html').keydown @keydownHandler\n\n  onBeforeDestroy: ->\n    @collection.off \"pageable:state:change\"\n    $(\"html\").unbind \"keydown\", @keydownHandler\n\n  getAnotherPage: (direction) ->\n    currentPage = @collection.state.currentPage\n    onLastPage = currentPage is @collection.state.lastPage\n    response = undefined\n    if direction is 'prev' and currentPage\n      response = @collection.getPreviousPage()\n    else if direction is 'next' and not onLastPage\n      response = @collection.getNextPage()\n    if __DEV__ and response\n      response.done ->\n        console.log \"Cleanup?\"\n  getPreviousPage: ->\n    @getAnotherPage 'prev'\n  getNextPage: ->\n    @getAnotherPage 'next'\n    \nclass ItemView extends Marionette.View\n  template: itemTemplate\n  ui:\n    item: '.list-group-item'\n    link: 'a'\n  events:\n    'click @ui.link': 'showRole'\n  showRole: (event) ->\n    event.preventDefault()\n    MessageChannel.request 'success', 'Cool!'\n    \nclass ItemCollectionView extends Marionette.CollectionView\n  childView: ItemView\n\nclass ListView extends Marionette.View\n  template: listTemplate\n  ui:\n    header: '.listview-header'\n    itemList: '.list-group'\n    paginateBar: '.paginate-bar'\n  regions:\n    itemList: '@ui.itemList'\n    paginateBar: '@ui.paginateBar'\n    navBox: '.navbox'\n  onRender: ->\n    view = new ItemCollectionView\n      collection: @collection\n    @showChildView 'itemList', view\n    view = new PaginateBar\n      collection: @collection\n      setKeyHandler: true\n    @showChildView 'paginateBar', view\n    #view = new NavigateBox\n    #  collection: @collection\n    #@showChildView 'navBox', view\n    \nview_template = tc.renderable (model) ->\n  tc.div '.row.listview-list-entry', ->\n    tc.raw marked \"# #{model.appName} started.\"\n    \nclass MainView extends Marionette.View\n  template: view_template\n  templateContext:\n    appName: 'usgov'\n    \nmodule.exports = ListView\n\n","import $ from 'jquery'\nimport Backbone from 'backbone'\nimport Marionette from 'backbone.marionette'\nimport tc from 'teacup'\n\nMainChannel = Backbone.Radio.channel 'global'\nMessageChannel = Backbone.Radio.channel 'messages'\n\n# this needs to be contained in a 'nav' region\nexport default class PaginationView extends Marionette.View\n  tagName: 'ul'\n  className: 'pagination'\n  template: tc.renderable (model) ->\n    if model instanceof Backbone.Collection\n      state = model.state\n    else\n      state = model.collection.state\n    totalPages = state.totalPages\n    firstPage = state.firstPage\n    lastPage = state.lastPage\n    tc.li '.page-item', ->\n      tc.a '.prev.page-link.bg-body-d5', ->\n        tc.i '.fa.fa-arrow-left'\n    for p in [firstPage..lastPage]\n      tc.li '.page-item', ->\n        tc.a '.numbered-page.page-link.bg-body-d5.text-dark',\n        href:'#', data: pageNumber: p, p\n    tc.li '.page-item', ->\n      tc.a '.next.page-link.bg-body-d5', ->\n        tc.i '.fa.fa-arrow-right'\n  templateContext: ->\n    collection: @collection\n  ui:\n    numberedPage: '.numbered-page'\n    prevButton: '.prev'\n    nextButton: '.next'\n  events:\n    'click @ui.numberedPage': 'turnPage'\n    'click @ui.prevButton': 'getPreviousPage'\n    'click @ui.nextButton': 'getNextPage'\n  onDomRefresh: ->\n    @updateNavButtons()\n  turnPage: (event) ->\n    event.preventDefault()\n    el = $(event.target)\n    pageNumber = el.attr 'data-pagenumber'\n    @collection.getPage Number pageNumber\n    @updateNavButtons()\n\n  updateNavButtons: ->\n    state = @collection.state\n    prevItem = @ui.prevButton.parent()\n    if state.currentPage == state.firstPage\n      unless prevItem.hasClass 'disabled'\n        prevItem.addClass 'disabled'\n    else\n      if prevItem.hasClass 'disabled'\n        prevItem.removeClass 'disabled'\n    nextItem = @ui.nextButton.parent()\n    if state.currentPage == state.lastPage\n      unless nextItem.hasClass 'disabled'\n        nextItem.addClass 'disabled'\n    else\n      if nextItem.addClass 'disabled'\n        nextItem.removeClass 'disabled'\n    @ui.numberedPage.parent().removeClass 'active'\n    @ui.numberedPage.removeClass 'text-white'\n    @ui.numberedPage.addClass 'text-dark'\n    cp = $(\"[data-pagenumber=\\\"#{state.currentPage}\\\"]\")\n    cpp = cp.parent()\n    cpp.addClass 'active'\n    cp.removeClass 'text-dark'\n    cp.addClass 'text-white'\n\n  getAnotherPage: (direction) ->\n    state = @collection.state\n    onLastPage = state.currentPage == state.lastPage\n    # we need this in case the pages start at zero\n    onFirstPage = state.currentPage == state.firstPage\n    if direction is 'prev' and not onFirstPage\n      if state.currentPage != state.firstPage\n        resp = @collection.getPreviousPage()\n    else if direction is 'next' and not onLastPage\n      resp = @collection.getNextPage()\n    else if onLastPage\n      return\n    else\n      throw new Error \"bad direction '#{direction}'\"\n    @updateNavButtons()\n    return resp\n    \n  getPreviousPage: ->\n    return @getAnotherPage 'prev'\n      \n  getNextPage: ->\n    return @getAnotherPage 'next'\n      \n  onRender: ->\n    setKeyHandler = @getOption 'setKeyHandler'\n    if setKeyHandler\n      @onRenderHandleKeys()\n      \n  onBeforeDestroy: ->\n    setKeyHandler = @getOption 'setKeyHandler'\n    if setKeyHandler\n      @onBeforeDestroyHandleKeys()\n    \n  keycommands:\n    prev: 37\n    next: 39\n  handleKeyCommand: (command) ->\n    if command in ['prev', 'next']\n      @getAnotherPage command\n  keydownHandler: (event) =>\n    for key, value of @keycommands\n      if event.keyCode == value\n        @handleKeyCommand key\n\n  onRenderHandleKeys: ->\n    $(\"html\").keydown @keydownHandler\n\n  onBeforeDestroyHandleKeys: ->\n    $(\"html\").unbind 'keydown', @keydownHandler\n    \n"],"sourceRoot":""}