(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{35:function(e,t,r){"use strict";r.r(t);var s,a,n,i,o,l,u,c,h,d,p,f,g,m,v=r(2),b=r.n(v),y=r(44),w=r(3),P=r.n(w),R=r(1),x=r.n(R),k=(r(0),r(37)),S=(r(11),r(43)),C=(r(36),r(57)),N=r.n(C);r(6);x.a.Radio.channel("global"),x.a.Radio.channel("messages"),x.a.Radio.channel("resources"),s=function(){class e extends x.a.Collection{initialize(){return this.fetch(),this.on("change",this.save,this)}fetch(){var e;return e=JSON.parse(localStorage.getItem(this.local_storage_key))||[],this.set(e)}save(e){return localStorage.setItem(this.local_storage_key,JSON.stringify(this.toJSON()))}}return e.prototype.local_storage_key=null,e}.call(this),x.a.Radio.channel("global"),a=x.a.Radio.channel("bumblr"),h="//api.tumblr.com/v2",n=class extends x.a.Model{initialize(){return this.fetch(),this.on("change",this.save,this)}fetch(){return this.set(JSON.parse(localStorage.getItem(this.id)))}save(e,t){return localStorage.setItem(this.id,JSON.stringify(this.toJSON())),P.a.ajax({success:t.success,error:t.error})}destroy(e){return localStorage.removeItem(this.id)}isEmpty(){return _.size(this.attributes<=1)}},l=function(){class e extends N.a{url(){return`${this.baseURL}/blog/${this.blogName}/posts/photo?api_key=${this.apiKey}`}fetch(e){var t;return e||(e={}),e.data||{},t=this.state.currentPage*this.state.pageSize,e.offset=t,e.dataType="jsonp",super.fetch(e)}parse(e){var t;return t=e.response.total_posts,this.state.totalRecords=t,super.parse(e.response.posts)}}return e.prototype.mode="server",e.prototype.full=!0,e.prototype.baseURL=h,e.prototype.state={firstPage:0,pageSize:15},e.prototype.queryParams={pageSize:"limit",offset:function(){return this.state.currentPage*this.state.pageSize}},e}.call(this),u=function(){class e extends n{}return e.prototype.id="bumblr_settings",e}.call(this),i=function(){class e extends x.a.Model{}return e.prototype.baseURL=h,e}.call(this),o=class extends i{url(){return`${this.baseURL}/blog/${this.id}/info?api_key=${this.apiKey}&callback=?`}},d="4mhV8B1YQK6PUA2NW8eZZXVHjU55TPJ3UZnZGrbSoCnqJaxDyH",(f=new u).get("consumer_key")||(console.log("saving initial app settings"),f.set("consumer_key",d),f.save()),a.reply("get_app_settings",function(){return f}),c=function(){class e extends s{addBlog(e){var t,r;return r=`${e}.tumblr.com`,t=new this.model({id:r,name:e}),t.apiKey=f.get("consumer_key"),this.add(t),t.fetch().done(()=>this.save()),t}}return e.prototype.model=o,e}.call(this),a.reply("make-blog-post-collection",function(e){var t,r;return t=f.get("consumer_key"),(r=new l).apiKey=t,r.blogName=e,r}),a.reply("make-pix-collection",function(e){var t,r;return t=f.get("consumer_key"),(r=new l).state={firstPage:0,pageSize:1},r.apiKey=t,r.blogName=e,r}),p=new c({apiKey:f.get("consumer_key")}),a.reply("get-local-blogs",function(){return p}),m=r(56),g=x.a.Radio.channel("bumblr");var q,V,B,E=class extends S.a{set_header(e){return P()("#header").text(e)}start(){return this.setupLayoutIfNeeded(),this.set_header("Bumblr"),this.listBlogs()}default_view(){return this.start()}show_mainview(){var e;return e=new m.MainBumblrView,this.layout.showChildView("content",e),Object(k.a)()}showDashboard(){var e;return e=new m.BumblrDashboardView,this.layout.showChildView("content",e),Object(k.a)()}listBlogs(){return this.setupLayoutIfNeeded(),Promise.all([r.e(4),r.e(9)]).then((()=>{var e,t;return e=g.request("get-local-blogs"),t=new(r(64))({collection:e}),this.layout.showChildView("content",t)}).bind(null,r)).catch(r.oe)}viewBlog(e){return this.setupLayoutIfNeeded(),Promise.all([r.e(4),r.e(8)]).then((()=>{var t,s,a;return a=`${e}.tumblr.com`,s=g.request("make-blog-post-collection",a),t=r(63),s.fetch().done(()=>{var e;return e=new t({collection:s}),this.layout.showChildView("content",e),Object(k.a)()})}).bind(null,r)).catch(r.oe)}viewBlogPix(e){return this.setupLayoutIfNeeded(),Promise.all([r.e(4),r.e(8)]).then((()=>{var t,s,a;return a=`${e}.tumblr.com`,s=g.request("make-pix-collection",a),window.pix=s,t=r(62),s.getFirstPage().done(()=>{var e;return e=new t({collection:s}),this.layout.showChildView("content",e),Object(k.a)()})}).bind(null,r)).catch(r.oe)}addNewBlog(){return this.setupLayoutIfNeeded(),Promise.all([r.e(3),r.e(7)]).then((()=>{var e;return e=new(r(61)),this.layout.showChildView("content",e),Object(k.a)()}).bind(null,r)).catch(r.oe)}settingsPage(){return this.setupLayoutIfNeeded(),Promise.all([r.e(3),r.e(6)]).then((()=>{var e;return e=new(0,r(60).default)({model:g.request("get_app_settings")}),this.layout.showChildView("content",e),Object(k.a)()}).bind(null,r)).catch(r.oe)}};Backbone.Radio.channel("global"),V=Backbone.Radio.channel("bumblr"),B=function(){class e extends b.a.AppRouter{}return e.prototype.appRoutes={bumblr:"start","bumblr/settings":"settingsPage","bumblr/dashboard":"showDashboard","bumblr/listblogs":"listBlogs","bumblr/viewblog/:id":"viewBlog","bumblr/addblog":"addNewBlog","bumblr/viewpix/:id":"viewBlogPix"},e}.call(this),q=function(){class e extends y.a{onBeforeStart(){var e;return(e=V.request("get-local-blogs")).fetch(),e.isEmpty()&&["dutch-and-flemish-painters","gkar56","flowerfood","8bitfuture","dendroica"].forEach(function(t){return e.addBlog(t)}),super.onBeforeStart(arguments)}}return e.prototype.Controller=E,e.prototype.Router=B,e.prototype.appletEntries=[{label:"Bumblr Menu",menu:[{label:"List Blogs",url:"#bumblr/listblogs",icon:".fa.fa-list"},{label:"Add Blog",url:"#bumblr/addblog",icon:".fa.fa-plus"},{label:"Settings",url:"#bumblr/settings",icon:".fa.fa-gear"}]}],e}.call(this);t.default=q},36:function(e,t,r){"use strict";var s=r(1),a=r.n(s),n=r(2),i=r.n(n),o=r(0),l=r.n(o),u=r(12),c=r.n(u),h=function(){class e extends a.a.Marionette.View{}return e.prototype.template=l.a.renderable(function(){return l.a.div(".jumbotron",function(){return l.a.h1(function(){return l.a.text("Loading ..."),l.a.i(".fa.fa-spinner.fa-spin")})})}),e}.call(this);a.a.Radio.channel("global");var d,p,f,g,m=class extends i.a.Behavior{onDomRefresh(){var e;return e=new h,this.view.showChildView("content",e)}},v=(r(3),class extends i.a.Region{attachHtml(e){var t;return t=this.slide_speed?this.slide_speed:"fast",this.$el.hide(),this.$el.html(e.el),this.$el.slideDown(t)}});r(42);r.d(t,"a",function(){return f}),p=a.a.Radio.channel("navbar"),g=function(e=3,t="sm",r="left"){return l.a.renderable(function(){if("left"===r&&l.a.div(`#sidebar.col-${t}-${e}.left-column`),l.a.div(`#main-content.col-${t}-${12-e}`),"right"===r)return l.a.div(`#sidebar.col-${t}-${e}.right-column`)})},d=function(){class e extends i.a.View{onBeforeDestroy(){return p.request("get-entries","applet").reset()}}return e.prototype.className="applet-container",e.prototype.behaviors={ShowInitialEmptyContent:{behaviorClass:m}},e}.call(this),function(){class e extends d{}return e.prototype.template=g(),e.prototype.regions={sidebar:"#sidebar",content:"#main-content"},e}.call(this),f=function(){class e extends d{regions(){var e;return(e=new v({el:"#main-content"})).slide_speed=c()(".01s"),{content:e,toolbar:"#main-toolbar"}}}return e.prototype.template=l.a.renderable(function(){return l.a.div(".row",function(){return l.a.div("#main-toolbar")}),l.a.div(".row",function(){return l.a.div("#main-content")})}),e}.call(this)},37:function(e,t,r){"use strict";t.a=function(){return window.scrollTo(0,0)}},42:function(e,t,r){},43:function(e,t,r){"use strict";r.d(t,"a",function(){return n});r(3);var s,a,n,i=r(1),o=r.n(i),l=r(2),u=r.n(l),c=r(36),h=r(11),d=r(37);a=o.a.Radio.channel("global"),s=u.a.Object.extend({init_page:function(){},scrollTop:d.a,scroll_top:function(){return console.warn("use scrollTop instead"),this.scrollTop(arguments)},navigateToUrl:h.default,navigate_to_url:function(){return console.warn("use navigateToUrl instead"),this.navigateToUrl(arguments)}}),n=s.extend({layoutClass:c.a,_getAppletRegion:function(){return a.request("main:app:object").getView().getRegion("applet")},setupLayout:function(){var e,t;e=this.getOption("layoutClass"),this.layout=new e,(t=this._getAppletRegion()).hasView()&&t.empty(),this.applet.setupAppletEntries(),t.show(this.layout)},setup_layout:function(){console.warn("don't use setup_layout"),this.setupLayout()},setupLayoutIfNeeded:function(){void 0===this.layout?this.setupLayout():this.layout.isDestroyed()&&this.setupLayout()},setup_layout_if_needed:function(){console.warn("use setupLayoutIfNeeded instead"),this.setupLayoutIfNeeded()},_get_region:function(e){return console.warn("use _getRegion instead"),this._getRegion(e)},_show_view:function(e,t){return console.warn("use _showView instead"),this._showView(e,t)},_load_view:function(e,t,r){return console.warn("use _loadView instead"),this._loadView(e,t,r)},_getRegion:function(e){return this.layout.getRegion(e)},_showView:function(e,t){var r;r=new e({model:t}),this.layout.showChildView("content",r)},_isModelPresent:function(e){return e.isEmpty()||1===Object.keys(e.attributes).length},_loadView:function(e,t,r){var s;this._isModelPresent(t)?((s=t.fetch()).done(()=>{this._showView(e,t)}),s.fail(function(){var e;e=`Failed to load ${r} data.`,MessageChannel.request("danger",e)})):this._showView(e,t)}}),s.extend({channelName:function(){return this.getOption("channelName")||"global"},initialize:function(e){this.appletName=e.appletName,this.applet=a.request("main:applet:get-applet",this.appletName),this.mainController=this.applet.router.controller,this.channel=this.getChannel()},setup_layout_if_needed:function(){this.mainController.setup_layout_if_needed()},showChildView:function(e,t){this.mainController.layout.showChildView(e,t)}})},44:function(e,t,r){"use strict";var s,a,n=r(1),i=r.n(n),o=(r(2),r(5)),l=r.n(o),u=[].indexOf;i.a.Radio.channel("global"),s=i.a.Radio.channel("navbar"),a=class extends l.a.App{setupAppletEntries(){var e;if((e=s.request("get-entries","applet")).reset(),this.appletEntries)return e.set(this.appletEntries)}onBeforeStart(){var e,t,r,s,a;return this.setupAppletEntries(),(t=new this.Controller).applet=this,this.router=new this.Router({controller:t}),(null!=this?this.appRoutes:void 0)&&(e=("function"==typeof this.appRoutes?this.appRoutes():void 0)||this.appRoutes,Object.keys(e).forEach(t=>this.router.appRoute(t,e[t]))),(null!=(s=this.options)?s.isFrontdoorApplet:void 0)&&(r=(null!=(a=this.options.appConfig)?a.startFrontdoorMethod:void 0)||"start",u.call(Object.keys(this.router.appRoutes),"")<0&&this.router.appRoute("",r)),this._extraRouters={},this.initExtraRouters()}onStop(){0}setExtraRouter(e,t,r){var s;return s=new t({controller:new r}),this._extraRouters[e]=s}initExtraRouters(){var e,t,r,s;for(s in e=this.getOption("extraRouters"),this.getOption("extraRouters"),t=[],e)r=e[s],console.log("rtr",s,r),this.setExtraRouter(s,r.router,r.controller),t.push(void 0);return t}getExtraRouter(e){return this._extraRouters[e]}},t.a=a},56:function(e,t,r){var s,a,n,i,o,l;s=r(1),r(2),l=r(0),s.Radio.channel("bumblr"),o=l.renderable(function(e){return l.p("main bumblr view")}),i=l.renderable(function(e){return l.p("bumblr_dashboard_view")}),n=function(){class e extends s.Marionette.View{}return e.prototype.template=o,e}.call(this),a=function(){class e extends s.Marionette.View{}return e.prototype.template=i,e}.call(this),e.exports={MainBumblrView:n,BumblrDashboardView:a}},57:function(e,t,r){
/*
  backbone.paginator
  http://github.com/backbone-paginator/backbone.paginator

  Copyright (c) 2016 Jimmy Yuen Ho Wong and contributors

  @module
  @license MIT
*/
e.exports=function(e,t){"use strict";var r=e.extend,s=e.omit,a=e.clone,n=e.each,i=e.pick,o=e.includes,l=e.isEmpty,u=e.pairs||e.toPairs,c=e.invert,h=e.isArray,d=e.isFunction,p=e.isObject,f=e.keys,g=e.isUndefined,m=Math.ceil,v=Math.floor,b=Math.max,y=t.Collection.prototype;function w(t,r){if(!e.isNumber(t)||e.isNaN(t)||!e.isFinite(t)||~~t!==t)throw new TypeError("`"+r+"` must be a finite integer");return t}function P(e,t,r){var s=e._events[t];if(s&&s.length){var a=s[s.length-1],n=a.callback;a.callback=function(){try{n.apply(this,arguments),r()}catch(e){throw e}finally{a.callback=n}}}else r()}var _=/[\s'"]/g,R=/[<>\s'"]/g,x=t.PageableCollection=t.Collection.extend({state:{firstPage:1,lastPage:null,currentPage:null,pageSize:25,totalPages:null,totalRecords:null,sortKey:null,order:-1},mode:"server",queryParams:{currentPage:"page",pageSize:"per_page",totalPages:"total_pages",totalRecords:"total_entries",sortKey:"sort_by",order:"order",directions:{"-1":"asc",1:"desc"}},constructor:function(e,t){y.constructor.apply(this,arguments),t=t||{};var s=this.mode=t.mode||this.mode||k.mode,n=r({},k.queryParams,this.queryParams,t.queryParams||{});n.directions=r({},k.queryParams.directions,this.queryParams.directions,n.directions),this.queryParams=n;var i=this.state=r({},k.state,this.state,t.state);i.currentPage=null==i.currentPage?i.firstPage:i.currentPage,h(e)||(e=e?[e]:[]),e=e.slice(),"server"==s||null!=i.totalRecords||l(e)||(i.totalRecords=this.length),this.switchMode(s,r({fetch:!1,resetState:!1,models:e},t));var o=t.comparator;if(i.sortKey&&!o&&this.setSorting(i.sortKey,i.order,t),"server"!=s){var u=this.fullCollection;o&&t.full&&(this.comparator=null,u.comparator=o),t.full&&u.sort(),l(e)||this.getPage(i.currentPage)}this._initState=a(this.state)},_makeFullCollection:function(e,r){var s,a,n,i=["url","model","sync","comparator"],o=this.constructor.prototype,l={};for(s=0,a=i.length;s<a;s++)g(o[n=i[s]])||(l[n]=o[n]);var u=new(t.Collection.extend(l))(e,r);for(s=0,a=i.length;s<a;s++)this[n=i[s]]!==o[n]&&(u[n]=this[n]);return u},_makeCollectionEventHandler:function(e,t){return function(s,i,o,l){var u=e._handlers;n(f(u),function(r){var s=u[r];e.off(r,s),t.off(r,s)});var c=a(e.state),h=c.firstPage,d=0===h?c.currentPage:c.currentPage-1,p=c.pageSize,v=d*p,b=v+p;if("add"==s){var y,w,_,l=l||{};if(o==t)(w=t.indexOf(i))>=v&&w<b&&(_=e,y=R=w-v);else{y=e.indexOf(i),w=v+y,_=t;var R=g(l.at)?w:l.at+v}if(l.onRemove||(++c.totalRecords,delete l.onRemove),e.state=e._checkState(c),_){_.add(i,r({},l,{at:R}));var x=y>=p?i:!g(l.at)&&R<b&&e.length>p?e.at(p):null;x&&P(o,s,function(){e.remove(x,{onAdd:!0})})}l.silent||e.trigger("pageable:state:change",e.state)}if("remove"==s){if(l.onAdd)delete l.onAdd;else{if(--c.totalRecords){var k=c.totalPages=m(c.totalRecords/p);c.lastPage=0===h?k-1:k||h,c.currentPage>k&&(c.currentPage=c.lastPage)}else c.totalRecords=null,c.totalPages=null;e.state=e._checkState(c);var S,C=l.index;o==e?((S=t.at(b))?P(e,s,function(){e.push(S,{onRemove:!0})}):!e.length&&c.totalRecords&&e.reset(t.models.slice(v-p,b-p),r({},l,{parse:!1})),t.remove(i)):C>=v&&C<b&&((S=t.at(b-1))&&P(e,s,function(){e.push(S,{onRemove:!0})}),e.remove(i),!e.length&&c.totalRecords&&e.reset(t.models.slice(v-p,b-p),r({},l,{parse:!1})))}l.silent||e.trigger("pageable:state:change",e.state)}if("reset"==s){if(l=o,(o=i)==e&&null==l.from&&null==l.to){var N=t.models.slice(0,v),q=t.models.slice(v+e.models.length);t.reset(N.concat(e.models).concat(q),l)}else o==t&&((c.totalRecords=t.models.length)||(c.totalRecords=null,c.totalPages=null),"client"==e.mode&&(h=c.lastPage=c.currentPage=c.firstPage,d=0===h?c.currentPage:c.currentPage-1,b=(v=d*p)+p),e.state=e._checkState(c),e.reset(t.models.slice(v,b),r({},l,{parse:!1})));l.silent||e.trigger("pageable:state:change",e.state)}"sort"==s&&(l=o,(o=i)===t&&e.reset(t.models.slice(v,b),r({},l,{parse:!1}))),n(f(u),function(r){var s=u[r];n([e,t],function(e){e.on(r,s);var t=e._events[r]||[];t.unshift(t.pop())})})}},_checkState:function(e){var t=this.mode,r=this.links,s=e.totalRecords,a=e.pageSize,n=e.currentPage,i=e.firstPage,o=e.totalPages;if(null!=s&&null!=a&&null!=n&&null!=i&&("infinite"!=t||r)){if(s=w(s,"totalRecords"),a=w(a,"pageSize"),n=w(n,"currentPage"),i=w(i,"firstPage"),a<1)throw new RangeError("`pageSize` must be >= 1");if(o=e.totalPages=m(s/a),i<0||i>1)throw new RangeError("`firstPage must be 0 or 1`");if(e.lastPage=0===i?b(0,o-1):o||i,"infinite"==t){if(!r[n])throw new RangeError("No link found for page "+n)}else if(n<i||o>0&&(i?n>o:n>=o))throw new RangeError("`currentPage` must be firstPage <= currentPage "+(i?"<":"<=")+" totalPages if "+i+"-based. Got "+n+".")}return e},setPageSize:function(e,t){e=w(e,"pageSize"),t=t||{first:!1};var a=this.state,n=m(a.totalRecords/e),i=n?b(a.firstPage,v(n*a.currentPage/a.totalPages)):a.firstPage;return a=this.state=this._checkState(r({},a,{pageSize:e,currentPage:t.first?a.firstPage:i,totalPages:n})),this.getPage(a.currentPage,s(t,["first"]))},switchMode:function(t,i){if(!o(["server","client","infinite"],t))throw new TypeError('`mode` must be one of "server", "client" or "infinite"');i=i||{fetch:!0,resetState:!0};var l=this.state=i.resetState?a(this._initState):this._checkState(r({},this.state));this.mode=t;var u,c=this,h=this.fullCollection,d=this._handlers=this._handlers||{};if("server"==t||h)"server"==t&&h&&(n(f(d),function(e){u=d[e],c.off(e,u),h.off(e,u)}),delete this._handlers,this._fullComparator=h.comparator,delete this.fullCollection);else{(h=this._makeFullCollection(i.models||[],i)).pageableCollection=this,this.fullCollection=h;var p=this._makeCollectionEventHandler(this,h);n(["add","remove","reset","sort"],function(t){d[t]=u=e.bind(p,{},t),c.on(t,u),h.on(t,u)}),h.comparator=this._fullComparator}if("infinite"==t)for(var g=this.links={},v=l.firstPage,y=m(l.totalRecords/l.pageSize),w=0===v?b(0,y-1):y||v,P=l.firstPage;P<=w;P++)g[P]=this.url;else this.links&&delete this.links;return i.silent||this.trigger("pageable:state:change",l),i.fetch?this.fetch(s(i,"fetch","resetState")):this},hasPreviousPage:function(){var e=this.state,t=e.currentPage;return"infinite"!=this.mode?t>e.firstPage:!!this.links[t-1]},hasNextPage:function(){var e=this.state,t=this.state.currentPage;return"infinite"!=this.mode?t<e.lastPage:!!this.links[t+1]},getFirstPage:function(e){return this.getPage("first",e)},getPreviousPage:function(e){return this.getPage("prev",e)},getNextPage:function(e){return this.getPage("next",e)},getLastPage:function(e){return this.getPage("last",e)},getPage:function(e,t){var a=this.mode,n=this.fullCollection;t=t||{fetch:!1};var i=this.state,o=i.firstPage,u=i.currentPage,c=i.lastPage,h=i.pageSize,d=e;switch(e){case"first":d=o;break;case"prev":d=u-1;break;case"next":d=u+1;break;case"last":d=c;break;default:d=w(e,"index")}this.state=this._checkState(r({},i,{currentPage:d})),t.silent||this.trigger("pageable:state:change",this.state),t.from=u,t.to=d;var p=(0===o?d:d-1)*h,f=n&&n.length?n.models.slice(p,p+h):[];return"client"!=a&&("infinite"!=a||l(f))||t.fetch?("infinite"==a&&(t.url=this.links[d]),this.fetch(s(t,"fetch"))):(this.reset(f,s(t,"fetch")),this)},getPageByOffset:function(e,t){if(e<0)throw new RangeError("`offset must be > 0`");e=w(e,"offset");var r=v(e/this.state.pageSize);return 0!==this.state.firstPage&&r++,r>this.state.lastPage&&(r=this.state.lastPage),this.getPage(r,t)},sync:function(e,s,a){var n=this;if("infinite"==n.mode){var i=a.success,o=n.state.currentPage;a.success=function(e,t,s){var l=n.links,u=n.parseLinks(e,r({xhr:s},a));u.first&&(l[n.state.firstPage]=u.first),u.prev&&(l[o-1]=u.prev),u.next&&(l[o+1]=u.next),i&&i(e,t,s)}}return(y.sync||t.sync).call(n,e,s,a)},parseLinks:function(e,t){var r={},s=t.xhr.getResponseHeader("Link");if(s){var a=["first","prev","next"];n(s.split(","),function(e){var t=e.split(";"),s=t[0].replace(R,""),i=t.slice(1);n(i,function(e){var t=e.split("="),n=t[0].replace(_,""),i=t[1].replace(_,"");"rel"==n&&o(a,i)&&(r[i]=s)})})}return r},parse:function(e,t){var s=this.parseState(e,a(this.queryParams),a(this.state),t);return s&&(this.state=this._checkState(r({},this.state,s)),(t||{}).silent||this.trigger("pageable:state:change",this.state)),this.parseRecords(e,t)},parseState:function(t,r,i,o){if(t&&2===t.length&&p(t[0])&&h(t[1])){var l=a(i),d=t[0];return n(u(s(r,"directions")),function(t){var r=t[0],s=t[1],a=d[s];g(a)||e.isNull(a)||(l[r]=d[s])}),d.order&&(l.order=1*c(r.directions)[d.order]),l}},parseRecords:function(e,t){return e&&2===e.length&&p(e[0])&&h(e[1])?e[1]:e},fetch:function(t){t=t||{};var a=this._checkState(this.state),o=this.mode;"infinite"!=o||t.url||(t.url=this.links[a.currentPage]);var l=t.data||{},c=t.url||this.url||"";d(c)&&(c=c.call(this));var p=c.indexOf("?");-1!=p&&(r(l,function(e){for(var t,r,s,a,n={},i=decodeURIComponent,o=e.split("&"),l=0,u=o.length;l<u;l++){var c=o[l];t=c.split("="),r=t[0],null==(s=t[1])&&(s=!0),r=i(r),s=i(s),a=n[r],h(a)?a.push(s):n[r]=a?[a,s]:s}return n}(c.slice(p+1))),c=c.slice(0,p)),t.url=c,t.data=l;var m="client"==this.mode?i(this.queryParams,"sortKey"):s(i(this.queryParams,f(k.queryParams)),"order","directions","totalPages","totalRecords");n(m,function(t,r){t=d(t)?t.call(this):t,null!=a[r]&&null!=t&&e.isUndefined(l[t])&&(l[t]=a[r])},this);var v=d(this.queryParams.sortKey)?this.queryParams.sortKey.call(this):this.queryParams.sortKey,b=d(this.queryParams.order)?this.queryParams.order.call(this):this.queryParams.order;if(null!=v&&null!=a.sortKey&&null!=b&&null!=a.order)if(h(a.order)){l[b]=[];for(var w=0;w<a.order.length;w++)l[b].push(this.queryParams.directions[a.order[w]])}else l[b]=this.queryParams.directions[a.order+""];for(var P=u(s(this.queryParams,f(k.queryParams))),w=0;w<P.length;w++){var _=P[w],R=_[1];null!=(R=d(R)?R.call(this):R)&&(l[_[0]]=R)}if("server"!=o){var x=this,S=this.fullCollection,C=t.success;return t.success=function(e,s,a){a=a||{},g(t.silent)?delete a.silent:a.silent=t.silent;var n=e.models;"client"==o?S.reset(n,a):(S.add(n,r({at:S.length},r(a,{parse:!1}))),x.trigger("reset",x,a)),C&&C(e,s,a)},y.fetch.call(this,r({},t,{silent:!0}))}return y.fetch.call(this,t)},_makeComparator:function(e,t,r){var s=this.state;if(e=e||s.sortKey,t=t||s.order,e&&t)return r||(r=function(e,t){return e.get(t)}),function(s,a){var n,i=r(s,e),o=r(a,e);return 1===t&&(n=i,i=o,o=n),i===o?0:i<o?-1:1}},setSorting:function(e,t,s){var a=this.state;a.sortKey=e,a.order=t=t||a.order;var n=this.fullCollection,i=!1,o=!1;e||(i=o=!0);var l=this.mode;s=r({side:"client"==l?l:"server",full:!0},s);var u=this._makeComparator(e,t,s.sortValue),c=s.full,h=s.side;return"client"==h?c?(n&&(n.comparator=u),i=!0):(this.comparator=u,o=!0):"server"!=h||c||(this.comparator=u),i&&(this.comparator=null),o&&n&&(n.comparator=null),this}}),k=x.prototype;return x}(r(6),r(1))}}]);