{"version":3,"sources":["webpack:///./src/applets/ebcsv/views/csvpreview.coffee","webpack:///./node_modules/tbirds/src/templates/forms.coffee","webpack:///./node_modules/tbirds/src/templates/buttons.coffee"],"names":["AppChannel","Backbone","BaseModalView","ComicsView","CsvMainView","CsvTableBody","CsvTableRow","MainChannel","MessageChannel","ModalDescView","ModalRowView","bstableclasses","cell_style","create_csv_data","csvRowCollection","dateFormat","fileexchange_upload_url","form_group_input_div","make_csv_headline","make_field_input","make_field_select","modal_close_button","tc","indexOf","__webpack_require__","Radio","channel","request","Collection","reply","csvheader","field","fields","push","join","collection","data","i","len","line","lines","ref","value","values","models","length","toJSON","split","call","template","renderable","model","mainsection","div","h4","Title","hr","raw","Description","ul","li","[object Object]","options","this","h3","dl","Object","keys","forEach","dt","dd","Marionette","View","view","tagName","td","style","ui","desc_btn","row_btn","events","click @ui.desc_btn","click @ui.row_btn","CollectionView","childView","ebcfg_collection","ebdsc_collection","showChildView","className","table","thead","tr","th","tbody","regions","body","el","replaceElement","window","open","filename","now","timestring","Date","filename_input","val","type","el_id","action","cdata","cfg","dsc","rows","comic","desc","set","csvrows","msg","urls","createCsvRows","text","input","name","mkcsv_btn","fileexchange_btn","click @ui.mkcsv_btn","click @ui.fileexchange_btn","module","exports","login_form","make_field_textarea","make_login_form","name_content_form","_util_capitalize__WEBPACK_IMPORTED_MODULE_1__","teacup__WEBPACK_IMPORTED_MODULE_0___default","a","atts","input_type","selector","label","for","input_id","input_attributes","content","placeholder","optlist","select","opt","results","option","selected","method","user","form","role","button","textarea","divbutton","dropdown_toggle","navbar_collapse_button","spanbutton","teacup__WEBPACK_IMPORTED_MODULE_0__","n","component","attrs","renderContents","span","icon","data-dismiss","target","data-toggle","data-target","href"],"mappings":"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","file":"ebcsv-view-csvpreview-view-helper-85b66152361e2866e1ae.js","sourcesContent":["$ = require 'jquery'\nBackbone = require 'backbone'\nMarionette = require 'backbone.marionette'\nMasonry = require 'masonry-layout'\ntc = require 'teacup'\ndateFormat = require 'dateformat'\n#require('editable-table/mindmup-editabletable')\n\nnavigate_to_url = require 'tbirds/util/navigate-to-url'\n{ make_field_input\n  make_field_select } = require 'tbirds/templates/forms'\n{ form_group_input_div } = require 'tbirds/templates/forms'\n{ modal_close_button } = require 'tbirds/templates/buttons'\n\nMainChannel = Backbone.Radio.channel 'global'\nMessageChannel = Backbone.Radio.channel 'messages'\nAppChannel = Backbone.Radio.channel 'ebcsv'\n\nBaseModalView = MainChannel.request 'main:app:BaseModalView'\n\nfileexchange_upload_url = \\\n  \"http://bulksell.ebay.com/ws/eBayISAPI.dll?FileExchangeUploadForm\"\n\ncsvRowCollection = new Backbone.Collection\nAppChannel.reply 'get-csvrow-collection', ->\n  csvRowCollection\n  \nmake_csv_headline = () ->\n  csvheader = AppChannel.request 'get-csv-header'\n  fields = []\n  for field of csvheader\n    fields.push csvheader[field]\n  \"#{fields.join(',')}\"\n  \ncreate_csv_data = () ->\n  collection = AppChannel.request 'get-csvrow-collection'\n  csvheader = AppChannel.request 'get-csv-header'\n  lines = [make_csv_headline()]\n  for row in collection.models\n    data = row.toJSON()\n    values = []\n    for field of data\n      value = data[field]\n      # escape double quotes\n      # https://stackoverflow.com/a/17606289\n      value = value.split('\"').join('\"\"')\n      # quote the value if it contains a space\n      if ' ' in value\n        value = '\"' + value + '\"'\n      values.push value\n    line = values.join(',')\n    lines.push line\n  content =  lines.join('\\r\\n')\n  return \"#{content}\\r\\n\"\n\n############################################\n# csv info preview dialogs\n############################################\n  \nclass ModalDescView extends BaseModalView\n  template: tc.renderable (model) ->\n    main = model.mainsection\n    tc.div '.modal-dialog', ->\n      tc.div '.modal-content', ->\n        tc.h4 \"Title: #{model.Title}\"\n        tc.div '.modal-body', ->\n          tc.h4 \"Description:\"\n          tc.hr()\n          tc.div '.panel', ->\n            tc.raw model.Description\n        tc.div '.modal-footer', ->\n          tc.ul '.list-inline', ->\n            btnclass = 'btn.btn-default.btn-sm'\n            tc.li \"#close-modal\", ->\n              modal_close_button 'Close', 'check'\n\nclass ModalRowView extends BaseModalView\n  templateContext: ->\n    options = @options\n    options.csvheader = AppChannel.request 'get-csv-header'\n    options\n  template: tc.renderable (model) ->\n    tc.div '.modal-dialog', ->\n      tc.div '.modal-content', ->\n        tc.h3 \"Title: #{model.Title}\"\n        tc.div '.modal-body', ->\n          tc.h4 \"CSV Row:\"\n          tc.hr()\n          tc.div '.panel', ->\n            tc.dl '.dl-horizontal', ->\n              Object.keys(model).forEach (field) ->\n                tc.dt model.csvheader[field]\n                tc.dd model[field]\n        tc.div '.modal-footer', ->\n          tc.ul '.list-inline', ->\n            tc.li \"#close-modal\", ->\n              modal_close_button 'Close', 'check'\n\n############################################\n# csv table views\n############################################\n              \n# text overflow for table cells\n# https://stackoverflow.com/a/11877033\ncell_styles = [\n  'max-width:0'\n  'overflow:hidden'\n  'text-overflow:ellipsis'\n  'white-space:nowrap'\n  ]\ncell_style = \"#{cell_styles.join(';')};\"\n\nclass CsvTableRow extends Backbone.Marionette.View\n  tagName: 'tr'\n  templateContext: ->\n    options = @options\n    options.csvheader = AppChannel.request 'get-csv-header'\n    options\n    \n  template: tc.renderable (model) ->\n    tc.td ->\n      tc.div '.btn-group.btn-group-justified', ->\n        tc.div '.show-desc-button.btn.btn-default.btn-xs', ->\n          tc.i '.fa.fa-eye'\n        tc.div '.show-row-button.btn.btn-default.btn-xs', ->\n          tc.i '.fa.fa-list'\n    Object.keys(model.csvheader).forEach (field) ->\n      tc.td style:cell_style, model[field]\n  ui:\n    desc_btn: '.show-desc-button'\n    row_btn: '.show-row-button'\n  events:\n    'click @ui.desc_btn': 'show_description'\n    'click @ui.row_btn': 'show_row'\n\n  show_row: ->\n    view = new ModalRowView\n      model: @model\n    MainChannel.request 'show-modal', view\n    \n  show_description: ->\n    view = new ModalDescView\n      model: @model\n    MainChannel.request 'show-modal', view\n    \n  \nclass CsvTableBody extends Backbone.Marionette.CollectionView\n  tagName: 'tbody'\n  childView: CsvTableRow\n\nbstableclasses = [\n  'table'\n  'table-striped'\n  'table-bordered'\n  'table-hover'\n  'table-condensed'\n  ]\n  \nclass CsvMainView extends Backbone.Marionette.View\n  tagName: 'table'\n  className: bstableclasses.join ' '\n  templateContext: ->\n    options = @options\n    options.ebcfg_collection = AppChannel.request 'ebcfg-collection'\n    options.ebdsc_collection = AppChannel.request 'ebdsc-collection'\n    options.csvheader = AppChannel.request 'get-csv-header'\n    options\n    \n  template: tc.renderable (model) ->\n    tc.div '.table-responsive', ->\n      tc.table \".#{bstableclasses.join '.'}\", ->\n        tc.thead ->\n          tc.tr '.info', ->\n            tc.td ->\n              # FIXME the big eye is to get the\n              # two view buttons to sit side by side.\n              tc.i '.fa.fa-eye.fa-3x'\n            Object.keys(model.csvheader).forEach (field) ->\n              tc.th model.csvheader[field]\n        tc.tbody()\n      \n  regions:\n    body:\n      el: 'tbody'\n      replaceElement: true\n\n  onRender: ->\n    #console.log \"CsvMainView onRender\"\n    collection = AppChannel.request 'get-csvrow-collection'\n    view = new CsvTableBody\n      collection: collection\n    @showChildView 'body', view\n    \n############################################\n# Main view\n############################################\nclass ComicsView extends Backbone.Marionette.View\n  templateContext: ->\n    options = @options\n    options.ebcfg_collection = AppChannel.request 'ebcfg-collection'\n    options.ebdsc_collection = AppChannel.request 'ebdsc-collection'\n    options\n  regions:\n    body: '.body'\n  template: tc.renderable (model) ->\n    now = new Date()\n    #sformat = \"yyyy-mm-dd-HH:MM:ss\"\n    sformat = \"mmddHHMM\"\n    timestring = dateFormat now, sformat\n    filename = \"export-#{timestring}.csv\"\n    tc.div '.listview-header', ->\n      tc.text \"Preview CSV\"\n    tc.div '.fileexchange-button.btn.btn-default', \"Ebay Upload\"\n    tc.div '.mkcsv-button.btn.btn-default', \"Create CSV\"\n    tc.input '.form-control', value:filename, name:'csvfilename'\n    tc.div '.body'\n  ui:\n    mkcsv_btn: '.mkcsv-button'\n    filename_input: \"input[name='csvfilename']\"\n    fileexchange_btn: '.fileexchange-button'\n  events:\n    'click @ui.mkcsv_btn': 'make_csv_file'\n    'click @ui.fileexchange_btn': 'open_fileexchange_tab'\n\n  open_fileexchange_tab: ->\n    window.open fileexchange_upload_url, '_blank'\n    \n  make_csv_file: ->\n    csvdata = create_csv_data()\n    now = new Date()\n    sformat = \"yyyy-mm-dd-HH:MM:ss\"\n    timestring = dateFormat now, sformat\n    filename = @ui.filename_input.val() or \"export-#{timestring}.csv\"\n    options =\n      type: 'data:text/csv;charset=utf-8'\n      data: create_csv_data()\n      el_id: 'exported-csv-anchor'\n      filename: filename\n    MainChannel.request 'export-to-file', options\n    \n  createCsvRows: ->\n    action = AppChannel.request 'get-current-csv-action'\n    cfg = AppChannel.request 'get-current-csv-cfg'\n    dsc = AppChannel.request 'get-current-csv-dsc'\n    rows = []\n    for comic in @collection.toJSON()\n      options =\n        action: action\n        comic: comic\n        cfg: cfg\n        desc: dsc\n      cdata = AppChannel.request 'create-csv-row-object', options\n      rows.push cdata\n    csvrows = AppChannel.request 'get-csvrow-collection'\n    csvrows.set rows\n\n  onRender: ->\n    urls = AppChannel.request 'get-comic-image-urls'\n    if not Object.keys(urls).length\n      msg = \"No pictures attached, please view comics, then create csv\"\n      MessageChannel.request 'warning', msg\n    @createCsvRows()\n    csvrows = AppChannel.request 'get-csvrow-collection'\n    view = new CsvMainView\n      collection: csvrows\n    @showChildView 'body', view\n    \n      \n    \nmodule.exports = ComicsView\n\n\n","import tc from 'teacup'\n\nimport capitalize from '../util/capitalize'\n\nif __useCssModules__\n  require \"../../sass/forms.scss\"\n\n########################################\n# Form Templates\n########################################\nform_group_input_div = tc.renderable (data) ->\n  tc.div '.form-group', ->\n    tc.label '.control-label',\n      for:data.input_id\n      data.label\n    selector = \"##{data.input_id}.form-control\"\n    atts = data.input_attributes\n    input_type = tc.input\n    if data?.input_type\n      input_type = tc[data.input_type]\n      input_type selector, atts, ->\n        tc.text data?.content\n    else\n      input_type selector, atts\n\nmake_field_input = (field) ->\n  tc.renderable (model) ->\n    form_group_input_div\n      input_id: \"input_#{field}\"\n      label: capitalize field\n      input_attributes:\n        name: field\n        placeholder: field\n        value: model[field]\n    \nmake_field_textarea = (field) ->\n  tc.renderable (model) ->\n    form_group_input_div\n      input_id: \"input_#{field}\"\n      input_type: 'textarea'\n      label: capitalize field\n      input_attributes:\n        name: field\n        placeholder: field\n      content: model[field]\n\nmake_field_select = (field, optlist) ->\n  tc.renderable (model) ->\n    tc.div '.form-group', ->\n      tc.label '.control-label',\n        for:\"select_#{field}\"\n      capitalize field\n    tc.select '.form-control', name:\"select_#{field}\", ->\n      for opt in optlist\n        if model[field] is opt\n          tc.option selected:null, value:opt, opt\n        else\n          tc.option value:opt, opt\n          \nmake_login_form = (action='/login', method='POST') ->\n  tc.renderable (user) ->\n    tc.form\n      role:'form'\n      method: method\n      action: action, ->\n        form_group_input_div\n          input_id: 'input_username'\n          label: 'User Name'\n          input_attributes:\n            name: 'username'\n            placeholder: 'User Name'\n        form_group_input_div\n          input_id: 'input_password'\n          label: 'Password'\n          input_attributes:\n            name: 'password'\n            type: 'password'\n            placeholder: 'Type your password here....'\n        tc.button '.btn.btn-secondary', type:'submit', 'login'\n\nlogin_form = make_login_form()\n\nname_content_form = tc.renderable (model) ->\n  form_group_input_div\n    input_id: 'input_name'\n    label: 'Name'\n    input_attributes:\n      name: 'name'\n      placeholder: 'Name'\n  form_group_input_div\n    input_id: 'input_content'\n    input_type: tc.textarea\n    label: 'Content'\n    input_attributes:\n      name: 'content'\n      placeholder: '...'\n  tc.input '.btn.btn-secondary.btn-sm', type:'submit', value:'Add'\n\n########################################\nexport {\n  form_group_input_div\n  make_field_input\n  make_field_textarea\n  make_field_select\n  make_login_form\n  login_form\n  name_content_form\n  }\n  \n","import tc from 'teacup'\n\n\n########################################\n# Button Templates\n########################################\nspanbutton = tc.component (selector, attrs, renderContents) ->\n  tc.span \"#{selector}.btn.btn-secondary.btn-sm\", renderContents\n\ndivbutton = tc.component (selector, attrs, renderContents) ->\n  tc.div \"#{selector}.btn.btn-secondary.btn-sm\", renderContents\n\nmodal_close_button = tc.renderable (label='Close', icon='close')->\n  tc.div '.btn.btn-secondary.btn-sm', 'data-dismiss': 'modal', ->\n    tc.h4 '.modal-title', ->\n      tc.i \".fa.fa-#{icon}\"\n      tc.text label\n\nnavbar_collapse_button  = tc.renderable (target) ->\n  tc.button '.navbar-toggle', type:'button', 'data-toggle':'collapse',\n  'data-target': \"##{target}\", ->\n    tc.span '.sr-only', 'Toggle Navigation'\n    tc.span '.icon-bar'\n    tc.span '.icon-bar'\n    tc.span '.icon-bar'\n\ndropdown_toggle = tc.component (selector, attrs, renderContents) ->\n  tc.a \"#{selector}.dropdown-toggle\", href:attrs.href,\n  'data-toggle':'dropdown', renderContents\n\nexport {\n  spanbutton\n  divbutton\n  modal_close_button\n  navbar_collapse_button\n  dropdown_toggle\n  }\n  \n"],"sourceRoot":""}