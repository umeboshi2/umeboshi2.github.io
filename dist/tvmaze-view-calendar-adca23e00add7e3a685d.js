(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{707:function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var r,a,i,l,c,s,u,d,f,p,h,w,v;r=n(31),i=n(6),s=n(7),f=n(78),h=n(442),n(708),n(709),c=i.Radio.channel("global"),a=i.Radio.channel("tvmaze"),i.Radio.channel("hubby"),v=n(34),u=v.renderable((function(){return v.div(".listview-header","Episodes"),v.div(".loading",(function(){return v.h2((function(){return v.i(".fa.fa-spinner.fa-spin"),v.text("Loading Episodes")}))})),v.div(".maincalendar")})),w=function(e,t){return e.url="#tvmaze/shows/view/"+e.showId,t.css({cursor:"pointer","font-size":"0.9em","font-family":"Rambla"})},p=function(e){var t,n;return n=r(".loading"),t=r(".fc-toolbar"),e?(n.show(),t.hide()):(n.hide(),t.show())},d=function(e,t,n,o){var r,i,l,s,u,d,p;return a.request("get-local-episode-model"),r=a.request("get-local-episode-collection"),p=(i=c.request("main:app:dbConn","tvmaze")).getSchema().table("TVMazeEpisode"),s=[],window.startMoment=e,d=e.toDate(),l=t.toDate(),s.push(p.airdate.gte(e)),s.push(p.airdate.lte(t)),u=i.select().from(p).where(f.op.and(p.airdate.gte(e.toDate()),p.airdate.lte(t.toDate()))),console.log("Q",u,d,l),u=u.exec(),console.log("Q",u),u.then((function(e){var t,n,a;return console.log("RESULTS",e),(t=new r).set(e),n=t.toJSON(),console.log("collection",t),a=[],n.forEach((function(e){var t,n,o;return t=h(e.airdate),o=e.runtime||30,n={id:e.id,showId:e.show_id,title:e.name,allDay:!1,start:t,end:t.add(o,"minutes"),url:"#tvmaze/shows/view/"+e.show_id},a.push(n)})),o(a)}))},l=function(){var e=function(e){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments));return e.calendarViewRender=e.calendarViewRender.bind(e),e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"onBeforeDestroy",value:function(){return this.ui.calendar.fullCalendar("destroy"),console.log("calendar destroyed")}},{key:"calendarViewRender",value:function(e,n){return function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")}(this,t),a.request("maincalendar:set-date",this.ui.calendar)}},{key:"onDomRefresh",value:function(){var e,t,n=this;return e=function(e){var t,o;return n.options.minicalendar?(t={layout:n.options.layout,region:"episode",id:e.id},a.request("view-episode",t)):(o=e.url,console.log("EVENT URL",e,o),i.history.navigate(o,{trigger:!0}))},t=a.request("maincalendar:get-date"),this.ui.calendar.fullCalendar({defaultDate:t,header:{left:"prevYear, nextYear",center:"title",right:"prev, next"},theme:!1,defaultView:"month",eventSources:[{events:d}],eventRender:w,viewRender:this.calendarViewRender,loading:p,eventClick:e}),console.log("we should either be fetching events, or refetching")}}]),t}(s.View);return e.prototype.template=u,e.prototype.ui={calendar:".maincalendar",loading:".loading",header:".fc-toolbar",daytop:".fc-day-top"},e.prototype.options={minicalendar:!1,layout:!1},e}.call(void 0),e.exports=l}}]);
//# sourceMappingURL=tvmaze-view-calendar-adca23e00add7e3a685d.js.map