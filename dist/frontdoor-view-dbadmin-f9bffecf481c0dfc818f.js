(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{153:function(e,t,n){"use strict";n.r(t),t.default=function(e){var t,n,i,r;return n=encodeURIComponent(e.data),r=`${e.type},${n}`,i=e.filename||"exported",(t=document.createElement("a")).id=e.elId||"exported-file-anchor",t.href=r,t.download=i,t.innerHTML=`Download ${i}`,t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)}},154:function(e,t){(function(t){e.exports=t}).call(this,{})},155:function(e,t,n){var i,r=r||function(e){"use strict";if(!(void 0===e||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var t=function(){return e.URL||e.webkitURL||e},n=e.document.createElementNS("http://www.w3.org/1999/xhtml","a"),i="download"in n,r=/constructor/i.test(e.HTMLElement)||e.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent),s=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},a=function(e){setTimeout(function(){"string"==typeof e?t().revokeObjectURL(e):e.remove()},4e4)},u=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e},l=function(l,d,p){p||(l=u(l));var h,c=this,f="application/octet-stream"===l.type,v=function(){!function(e,t,n){for(var i=(t=[].concat(t)).length;i--;){var r=e["on"+t[i]];if("function"==typeof r)try{r.call(e,n||e)}catch(e){s(e)}}}(c,"writestart progress write writeend".split(" "))};if(c.readyState=c.INIT,i)return h=t().createObjectURL(l),void setTimeout(function(){var e,t;n.href=h,n.download=d,e=n,t=new MouseEvent("click"),e.dispatchEvent(t),v(),a(h),c.readyState=c.DONE});!function(){if((o||f&&r)&&e.FileReader){var n=new FileReader;return n.onloadend=function(){var t=o?n.result:n.result.replace(/^data:[^;]*;/,"data:attachment/file;");e.open(t,"_blank")||(e.location.href=t),t=void 0,c.readyState=c.DONE,v()},n.readAsDataURL(l),void(c.readyState=c.INIT)}h||(h=t().createObjectURL(l)),f?e.location.href=h:e.open(h,"_blank")||(e.location.href=h);c.readyState=c.DONE,v(),a(h)}()},d=l.prototype;return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(e,t,n){return t=t||e.name||"download",n||(e=u(e)),navigator.msSaveOrOpenBlob(e,t)}:(d.abort=function(){},d.readyState=d.INIT=0,d.WRITING=1,d.DONE=2,d.error=d.onwritestart=d.onprogress=d.onwrite=d.onabort=d.onerror=d.onwriteend=null,function(e,t,n){return new l(e,t||e.name||"download",n)})}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);
/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */void 0!==e&&e.exports?e.exports.saveAs=r:null!==n(78)&&null!==n(154)&&(void 0===(i=function(){return r}.call(t,n,t,e))||(e.exports=i))},216:function(e,t,n){var i,r,o,s,a,u,l,d,p,h,c,f=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};n(4),i=n(2),d=n(3),c=n(0),a=n(49),n(48),o=n(155),n(153).default,u=i.Radio.channel("global"),p=i.Radio.channel("messages"),i.Radio.channel("ebcsv"),c.renderable(function(e){return c.div(".listview-list-entry",function(){return c.h2(e.name),c.div(".btn-group",function(){return c.button(".view.btn.btn-success",{type:"button"},"View"),c.button(".export.btn.btn-primary",{type:"button"},"Export"),c.button(".import.btn.btn-info",{type:"button"},"Import")}),c.div(".dbview")})}),h=c.renderable(function(e){return c.div(".card",function(){return c.div(".card-header",function(){return c.h2(e.name)}),c.div(".card-body",function(){return c.div(".file-status",function(){return c.text("Drop a .json exported database to import.")}),c.button(".view.btn.btn-success",{type:"button"},"View"),c.button(".export.btn.btn-primary",{type:"button"},"Export"),c.div(".import.btn.btn-info",{type:"button",style:"display:none"},function(){return c.text("Import Database")}),c.input(".db-file-input.input",{type:"file"}),c.button(".import-chosen.btn.btn-info",{style:"display:none"},function(){return c.text("Import input file")}),c.div(".dbview")})})}),r=function(){class e extends d.View{onDomRefresh(){var e;return e=this.model.toJSON(),this.jsonView=new a(e),this.ui.body.prepend(this.jsonView.dom)}}return e.prototype.template=c.renderable(function(e){return c.div(function(){return c.div(".body")})}),e.prototype.ui={body:".body"},e}.call(this),s=function(){class e extends d.View{constructor(){super(...arguments),this.fileReaderOnLoad=this.fileReaderOnLoad.bind(this)}fileInputClicked(e){return this.ui.fileInput.val(null),this.ui.importChosenButton.hide()}fileInputChanged(e){return this.ui.importChosenButton.show()}handleDrop(e){var t,n;return e.preventDefault(),this.$el.css("border","0px"),t=e.originalEvent.dataTransfer.files[0],this.droppedFile=t,n=`File: ${t.name}`,this.ui.fileStatus.text(n),this.ui.importButton.show()}handleDragOver(e){return e.preventDefault(),e.stopPropagation()}handleDragEnter(e){return e.stopPropagation(),e.preventDefault(),this.$el.css("border","2px dotted")}handleDragExit(e){return e.stopPropagation(),e.preventDefault(),this.$el.css("border","0px")}_exportDatabase(){return this.model.get("conn").export()}viewDatabase(){return this._exportDatabase().then(e=>{var t;return t=new r({model:new i.Model({data:e})}),this.showChildView("dbView",t),this.ui.viewButton.hide()})}exportDatabase(){return this._exportDatabase().then(e=>{var t,n,i;return n=this.model.get("name"),i={type:"data:text/json;charset=utf-8",data:JSON.stringify(e),filename:`${n}-idb.json`},t=new Blob([i.data],{type:i.type}),o.saveAs(t,i.filename),p.request("primary",`Exported Database ${n}`)})}fileReaderOnLoad(t){var n;return f(this,e),n=JSON.parse(t.target.result),this.ui.fileStatus.text("Database file loaded, now importing...."),this.model.get("conn").import(n).then(()=>this.viewDatabase())}importDatabase(){var e;return p.request("info",`Import Database ${this.model.get("name")}`),this.ui.fileStatus.text("Reading dabase file....."),(e=new FileReader).onload=this.fileReaderOnLoad,e.readAsText(this.droppedFile),this.ui.importButton.hide()}}return e.prototype.template=h,e.prototype.ui={viewButton:".view",exportButton:".export",importButton:".import",dbView:".dbview",fileInput:".db-file-input",importChosenButton:".import-chosen",fileStatus:".file-status"},e.prototype.regions={dbView:"@ui.dbView"},e.prototype.events={dragover:"handleDragOver",dragenter:"handleDragEnter",dragexit:"handleDragExit",drop:"handleDrop","click @ui.viewButton":"viewDatabase","click @ui.exportButton":"exportDatabase","click @ui.importButton":"importDatabase","click @ui.importChosenButton":"importChosenFile","click @ui.fileInput":"fileInputClicked","change @ui.fileInput":"fileInputChanged"},e}.call(this),l=function(){class e extends i.Marionette.View{onRender(){var e,t,n;return e=u.request("main:app:object"),t=e.getState("dbConn"),this.collection=new i.Collection,n=new d.CollectionView({collection:this.collection,childView:s}),this.showChildView("body",n),Object.keys(t).forEach(e=>this.collection.add({id:e,name:e,conn:t[e]}))}}return e.prototype.regions={body:".body"},e.prototype.template=c.renderable(function(e){return c.div(".listview-header",function(){return c.text("Indexed Database Admin")}),c.div(".body")}),e}.call(this),e.exports=l},55:function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function r(e){return"object"==typeof e&&null!==e}function o(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,s,a,u,l;if(this._events||(this._events={}),"error"===e&&(!this._events.error||r(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var d=new Error('Uncaught, unspecified "error" event. ('+t+")");throw d.context=t,d}if(o(n=this._events[e]))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),n.apply(this,a)}else if(r(n))for(a=Array.prototype.slice.call(arguments,1),s=(l=n.slice()).length,u=0;u<s;u++)l[u].apply(this,a);return!0},n.prototype.addListener=function(e,t){var s;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?r(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,r(this._events[e])&&!this._events[e].warned&&(s=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&s>0&&this._events[e].length>s&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var n=!1;function r(){this.removeListener(e,r),n||(n=!0,t.apply(this,arguments))}return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,t){var n,o,s,a;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(s=(n=this._events[e]).length,o=-1,n===t||i(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(r(n)){for(a=s;a-- >0;)if(n[a]===t||n[a].listener&&n[a].listener===t){o=a;break}if(o<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(o,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(i(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},78:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}}}]);
//# sourceMappingURL=frontdoor-view-dbadmin-f9bffecf481c0dfc818f.js.map