/*! For license information please see ebcsv-view-cached-comics-view-e5e472d3f25c617c584b.js.LICENSE */
(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{155:function(e,t,o){"use strict";var n,r,i,a,s,l,u,c,p=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}n=o(1),l=o(2),c=o(4);var m=o(85);m.make_field_input,m.make_field_select;var y=o(95);u=y.modal_close_button,s=n.Radio.channel("global"),n.Radio.channel("messages"),n.Radio.channel("ebcsv"),r=s.request("main:app:BaseModalView"),a=function(){var e=function(e){function t(){return f(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,e),t}(r);return e.prototype.template=c.renderable((function(e){return e.mainsection,c.div(".modal-dialog",(function(){return c.div(".modal-content",(function(){return c.div(".modal-body",(function(){return c.img({src:e.image_src})})),c.div(".modal-footer",(function(){return c.ul(".list-inline",(function(){return"btn.btn-default.btn-sm",c.li("#close-modal",(function(){return u("Close","check")}))}))}))}))}))})),e}.call(void 0),i=function(e){function t(){return f(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,e),p(t,[{key:"onShowImageModal",value:function(){var e;return e=new a({model:this.view.model}),s.request("show-modal",e)}}]),t}(l.Behavior),e.exports=i},156:function(e,t,o){"use strict";var n,r,i,a,s=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();o(1),r=o(2),i=o(89),a=o(92),n=function(){var e=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),s(t,[{key:"ui",value:function(){return{list:this.getOption("listContainer")}}},{key:"setMasonry",value:function(){var e,t;return e=this.getOption("listContainer"),t=this.getOption("masonryOptions"),this.view.masonry=new i(e,t)}},{key:"setMasonryLayout",value:function(){var e,t,o=this;return t=this.getOption("masonryOptions"),e=this.$(t.itemSelector),a(e,(function(){return o.view.masonry.reloadItems(),o.view.masonry.layout()}))}},{key:"onBeforeDestroy",value:function(){return this.view.masonry.destroy()}},{key:"onDomRefresh",value:function(){var e;if(this.setMasonry(),this.setMasonryLayout(),null!=(e=this.view)?e.afterDomRefresh:void 0)return this.view.afterDomRefresh()}}]),t}(r.Behavior);return e.prototype.options={listContainer:".list-container",channel:"global",masonryOptions:{gutter:1,isInitLayout:!1,itemSelector:".item",columnWidth:10,horizontalOrder:!0}},e.prototype.regions={list:"@ui.list"},e}.call(void 0),e.exports=n},318:function(e,t,o){"use strict";var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,l,u,c,p,f,d,h,m,y,v,b,g,_,w,k,O,C,j,E,I=[].indexOf;O=o(0),l=o(1),_=o(2),o(89),o(92),j=o(4),h=o(137),k=o(94),o(19);var T=o(85);T.make_field_input,T.make_field_select,o(85).form_group_input_div,v=o(156),y=o(155),m=o(319),g=l.Radio.channel("global"),w=l.Radio.channel("messages"),s=l.Radio.channel("ebcsv"),E=[{id:"server",label:"Server Images",url:"#ebcsv",icon:".fa.fa-server"},{id:"browser",label:"Browser Images",url:"#ebcsv",icon:".fa.fa-internet-explorer"}],f=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),n(t,[{key:"onChildviewToolbarEntryClicked",value:function(e){return this.trigger("toolbar:"+e.model.id+":click",e),console.log("onChildviewToolbarEntryClicked",e.model.id)}},{key:"onDomRefresh",value:function(){var e;return console.log("onDomRefresh",this.regions),e=this.getChildView("entries").$el,console.log("el is",e),e.removeClass("btn-group-justified")}}]),t}(k);return e.prototype.options={entryTemplate:j.renderable((function(e){return j.i(e.icon),j.text(" "),j.text(e.label)}))},e}.call(void 0),c=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(_.View);return e.prototype.ui={image:"img"},e.prototype.triggers={"click @ui.image":"show:image:modal"},e.prototype.behaviors=[y],e.prototype.template=j.renderable((function(e){var t;return t=(t=e.image_src.replace("/lg/","/sm/")).replace("http://","//"),j.div(".item",(function(){return j.img({src:t})}))})),e}.call(void 0),u=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),t}(_.CollectionView);return e.prototype.childView=c,e.prototype.emptyView=h,e}.call(void 0),C={browser:[{id:"destroy",label:"Delete All",icon:".fa.fa-erase"}],server:[{id:"backup",label:"Backup",icon:".fa.fa-download"},{id:"restore",label:"Restore",icon:".fa.fa-upload"}]},function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}a(t,e),n(t,[{key:"onChildviewToolbarEntryClicked",value:function(e){var t,o;return console.log("a button pressed",e),console.log(this.getOption("cacheType")+" toolbar"),t=this.getOption("cacheType"),o=["browser","server"],I.call(o,t)>=0?this[t+"ButtonClicked"](e):this.toolbarButtonClicked(e)}},{key:"toolbarButtonClicked",value:function(e){return console.warn("we don't have a cacheType on this toolbar")}},{key:"browserButtonClicked",value:function(e){return console.log("browser button",e)}},{key:"serverButtonClicked",value:function(e){return console.log("server button",e)}}])}(k),b=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),n(t,[{key:"onChildviewToolbarEntryClicked",value:function(){}}]),t}(k);return e.prototype.childViewTriggers={"toolbar:entry:clicked":"toolbar:entry:clicked"},e}.call(void 0),p=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),n(t,[{key:"ui",value:function(){return{toolbar:".toolbar",list:".list-container",header:".listview-header"}}},{key:"onRender",value:function(){var e,t,o;return t=new u({collection:this.collection}),this.showChildView("list",t),e=this.getOption("cacheType"),o=new b({collection:new l.Collection(C[e]),cacheType:e}),this.showChildView("toolbar",o),this.triggerMethod("set:header",this.collection.length+" images stored in the "+this.getOption("cacheType"))}},{key:"onChildviewToolbarEntryClicked",value:function(e){var t,o;return console.log("a button pressed",e),console.log(this.getOption("cacheType")+" toolbar"),t=this.getOption("cacheType"),o=["browser","server"],I.call(o,t)>=0?this[t+"ButtonClicked"](e):this.toolbarButtonClicked(e)}},{key:"toolbarButtonClicked",value:function(e){return console.warn("we don't have a cacheType on this toolbar")}},{key:"browserButtonClicked",value:function(e){if("destroy"===e.model.id)return this.destroyLocalImages()}},{key:"serverButtonClicked",value:function(e){var t;return"backup"===(t=e.model.id)?this.backupServerImages():"restore"===t?this.restoreServerImages():void 0}},{key:"backupServerImages",value:function(){var e,t=this;return(e=this.collection.fetch()).done((function(){var e,o,n,r,i,a;for(n=[],e=0,r=(a=t.collection.toJSON()).length;e<r;e++)delete(o=a[e]).id,n.push(o);return console.log("ITEMS",n),i={type:"data:text/json;charset=utf-8",data:JSON.stringify({items:n}),el_id:"exported-urls-anchor",filename:"url-backup.json"},g.request("export-to-file",i)})),e.fail((function(){return w.request("danger","Failed to get image urls!")}))}},{key:"restoreServerImages",value:function(){return console.warn("restoreServerImages")}},{key:"destroyLocalImages",value:function(){return s.request("clear-comic-image-urls"),this.collection.reset()}}]),t}(_.View);return e.prototype.regions={toolbar:"@ui.toolbar",list:"@ui.list"},e.prototype.behaviors={HasMasonryView:{behaviorClass:v,listContainer:".list-container",masonryOptions:{gutter:1,isInitLayout:!1,itemSelector:".item",columnWidth:10,horizontalOrder:!1}},HasHeader:{behaviorClass:m}},e.prototype.template=j.renderable((function(e){return j.div((function(){return j.div(".listview-header"),j.div(".toolbar"),j.div(".list-container")}))})),e}.call(void 0),d=function(){var e=function(e){function t(){return r(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),n(t,[{key:"onRender",value:function(){var e;return e=new f({collection:new l.Collection(E)}),this.showChildView("toolbar",e),this.triggerMethod("set:header","Cached Comic Cover Images")}},{key:"view_local_storage",value:function(){var e,t,o;return e=new l.Collection,delete(t=O.clone(s.request("get-comic-image-urls"))).id,Object.keys(t).forEach((function(o){var n;return n={url:o,image_src:t[o]},e.add(n)})),o=new p({collection:e,cacheType:"browser"}),this.showChildView("content",o)}},{key:"view_server_storage",value:function(){var e,t,o=this;return(t=(e=s.request("clzpage-collection")).fetch()).done((function(){var t;return t=new p({collection:e,cacheType:"server"}),o.showChildView("content",t)})),t.fail((function(){return w.request("danger","Failed to get cached comics")}))}}]),t}(_.View);return e.prototype.ui={content:".content-container",toolbar:".images-toolbar",header:".listview-header"},e.prototype.regions={content:"@ui.content",toolbar:"@ui.toolbar"},e.prototype.behaviors=[m],e.prototype.template=j.renderable((function(e){return j.div((function(){return j.div(".listview-header"),j.div(".images-toolbar"),j.div(".content-container")}))})),e.prototype.childViewEvents={"toolbar:browser:click":"view_local_storage","toolbar:server:click":"view_server_storage"},e}.call(void 0),e.exports=d},319:function(e,t,o){"use strict";var n,r,i=function(){function e(e,t){for(var o=0;o<t.length;o++){var n=t[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,o,n){return o&&e(t.prototype,o),n&&e(t,n),t}}();o(1),r=o(2),o(4),n=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"onSetHeader",value:function(e){return this.ui.header.text(e)}}]),t}(r.Behavior),e.exports=n},85:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.name_content_form=t.login_form=t.make_login_form=t.make_field_select=t.make_field_textarea=t.make_field_input=t.form_group_input_div=void 0;var n,r,i,a,s,l,u,c=f(o(4)),p=f(o(86));function f(e){return e&&e.__esModule?e:{default:e}}t.form_group_input_div=n=c.default.renderable((function(e){return c.default.div(".form-group",(function(){var t,o,n;return c.default.label(".control-label",{for:e.input_id},e.label),n="#"+e.input_id+".form-control",t=e.input_attributes,o=c.default.input,(null!=e?e.input_type:void 0)?(o=c.default[e.input_type])(n,t,(function(){return c.default.text(null!=e?e.content:void 0)})):o(n,t),c.default.div(".invalid-feedback")}))})),t.make_field_input=i=function(e){return c.default.renderable((function(t){return n({input_id:"input_"+e,label:(0,p.default)(e),input_attributes:{name:e,placeholder:e,value:t[e],data:{validation:e}}})}))},t.make_field_textarea=s=function(e){return c.default.renderable((function(t){return n({input_id:"input_"+e,input_type:"textarea",label:(0,p.default)(e),input_attributes:{name:e,placeholder:e,data:{validation:e}},content:t[e]})}))},t.make_field_select=a=function(e,t){return c.default.renderable((function(o){return c.default.div(".form-group",(function(){return c.default.label(".control-label",{for:"select_"+e}),(0,p.default)(e)})),c.default.select(".form-control",{name:"select_"+e},(function(){var n,r,i,a;for(a=[],n=0,r=t.length;n<r;n++)i=t[n],o[e]===i?a.push(c.default.option({selected:null,value:i},i)):a.push(c.default.option({value:i},i));return a}))}))},t.make_login_form=l=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/login",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"POST";return c.default.renderable((function(o){return c.default.form({role:"form",method:t,action:e},(function(){return n({input_id:"input_username",label:"User Name",input_attributes:{name:"username",placeholder:"User Name"}}),n({input_id:"input_password",label:"Password",input_attributes:{name:"password",type:"password",placeholder:"Type your password here...."}}),c.default.button(".btn.btn-secondary",{type:"submit"},"login")}))}))},t.login_form=r=l(),t.name_content_form=u=c.default.renderable((function(e){return n({input_id:"input_name",label:"Name",input_attributes:{name:"name",placeholder:"Name"}}),n({input_id:"input_content",input_type:c.default.textarea,label:"Content",input_attributes:{name:"content",placeholder:"..."}}),c.default.input(".btn.btn-secondary.btn-sm",{type:"submit",value:"Add"})})),t.form_group_input_div=n,t.make_field_input=i,t.make_field_textarea=s,t.make_field_select=a,t.make_login_form=l,t.login_form=r,t.name_content_form=u},92:function(e,t,o){var n,r;!function(i,a){"use strict";n=[o(112)],void 0===(r=function(e){return function(e,t){var o=e.jQuery,n=e.console;function r(e,t){for(var o in t)e[o]=t[o];return e}var i=Array.prototype.slice;function a(e,t,s){if(!(this instanceof a))return new a(e,t,s);var l,u=e;("string"==typeof e&&(u=document.querySelectorAll(e)),u)?(this.elements=(l=u,Array.isArray(l)?l:"object"==typeof l&&"number"==typeof l.length?i.call(l):[l]),this.options=r({},this.options),"function"==typeof t?s=t:r(this.options,t),s&&this.on("always",s),this.getImages(),o&&(this.jqDeferred=new o.Deferred),setTimeout(this.check.bind(this))):n.error("Bad element for imagesLoaded "+(u||e))}a.prototype=Object.create(t.prototype),a.prototype.options={},a.prototype.getImages=function(){this.images=[],this.elements.forEach(this.addElementImages,this)},a.prototype.addElementImages=function(e){"IMG"==e.nodeName&&this.addImage(e),!0===this.options.background&&this.addElementBackgroundImages(e);var t=e.nodeType;if(t&&s[t]){for(var o=e.querySelectorAll("img"),n=0;n<o.length;n++){var r=o[n];this.addImage(r)}if("string"==typeof this.options.background){var i=e.querySelectorAll(this.options.background);for(n=0;n<i.length;n++){var a=i[n];this.addElementBackgroundImages(a)}}}};var s={1:!0,9:!0,11:!0};function l(e){this.img=e}function u(e,t){this.url=e,this.element=t,this.img=new Image}return a.prototype.addElementBackgroundImages=function(e){var t=getComputedStyle(e);if(t)for(var o=/url\((['"])?(.*?)\1\)/gi,n=o.exec(t.backgroundImage);null!==n;){var r=n&&n[2];r&&this.addBackground(r,e),n=o.exec(t.backgroundImage)}},a.prototype.addImage=function(e){var t=new l(e);this.images.push(t)},a.prototype.addBackground=function(e,t){var o=new u(e,t);this.images.push(o)},a.prototype.check=function(){var e=this;function t(t,o,n){setTimeout((function(){e.progress(t,o,n)}))}this.progressedCount=0,this.hasAnyBroken=!1,this.images.length?this.images.forEach((function(e){e.once("progress",t),e.check()})):this.complete()},a.prototype.progress=function(e,t,o){this.progressedCount++,this.hasAnyBroken=this.hasAnyBroken||!e.isLoaded,this.emitEvent("progress",[this,e,t]),this.jqDeferred&&this.jqDeferred.notify&&this.jqDeferred.notify(this,e),this.progressedCount==this.images.length&&this.complete(),this.options.debug&&n&&n.log("progress: "+o,e,t)},a.prototype.complete=function(){var e=this.hasAnyBroken?"fail":"done";if(this.isComplete=!0,this.emitEvent(e,[this]),this.emitEvent("always",[this]),this.jqDeferred){var t=this.hasAnyBroken?"reject":"resolve";this.jqDeferred[t](this)}},l.prototype=Object.create(t.prototype),l.prototype.check=function(){this.getIsImageComplete()?this.confirm(0!==this.img.naturalWidth,"naturalWidth"):(this.proxyImage=new Image,this.proxyImage.addEventListener("load",this),this.proxyImage.addEventListener("error",this),this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.proxyImage.src=this.img.src)},l.prototype.getIsImageComplete=function(){return this.img.complete&&this.img.naturalWidth},l.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.img,t])},l.prototype.handleEvent=function(e){var t="on"+e.type;this[t]&&this[t](e)},l.prototype.onload=function(){this.confirm(!0,"onload"),this.unbindEvents()},l.prototype.onerror=function(){this.confirm(!1,"onerror"),this.unbindEvents()},l.prototype.unbindEvents=function(){this.proxyImage.removeEventListener("load",this),this.proxyImage.removeEventListener("error",this),this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},u.prototype=Object.create(l.prototype),u.prototype.check=function(){this.img.addEventListener("load",this),this.img.addEventListener("error",this),this.img.src=this.url,this.getIsImageComplete()&&(this.confirm(0!==this.img.naturalWidth,"naturalWidth"),this.unbindEvents())},u.prototype.unbindEvents=function(){this.img.removeEventListener("load",this),this.img.removeEventListener("error",this)},u.prototype.confirm=function(e,t){this.isLoaded=e,this.emitEvent("progress",[this,this.element,t])},a.makeJQueryPlugin=function(t){(t=t||e.jQuery)&&((o=t).fn.imagesLoaded=function(e,t){return new a(this,e,t).jqDeferred.promise(o(this))})},a.makeJQueryPlugin(),a}(i,e)}.apply(t,n))||(e.exports=r)}("undefined"!=typeof window?window:this)},95:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dropdown_toggle=t.navbar_collapse_button=t.modal_close_button=t.divbutton=t.spanbutton=void 0;var n,r,i,a,s,l,u=o(4),c=(n=u)&&n.__esModule?n:{default:n};t.spanbutton=l=c.default.component((function(e,t,o){return c.default.span(e+".btn.btn-secondary.btn-sm",o)})),t.divbutton=r=c.default.component((function(e,t,o){return c.default.div(e+".btn.btn-secondary.btn-sm",o)})),t.modal_close_button=a=c.default.renderable((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Close",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"close";return c.default.div(".btn.btn-secondary.btn-sm",{"data-dismiss":"modal"},(function(){return c.default.h4(".modal-title",(function(){return c.default.i(".fa.fa-"+t),c.default.text(e)}))}))})),t.navbar_collapse_button=s=c.default.renderable((function(e){return c.default.button(".navbar-toggle",{type:"button","data-toggle":"collapse","data-target":"#"+e},(function(){return c.default.span(".sr-only","Toggle Navigation"),c.default.span(".icon-bar"),c.default.span(".icon-bar"),c.default.span(".icon-bar")}))})),t.dropdown_toggle=i=c.default.component((function(e,t,o){return c.default.a(e+".dropdown-toggle",{href:t.href,"data-toggle":"dropdown"},o)})),t.spanbutton=l,t.divbutton=r,t.modal_close_button=a,t.navbar_collapse_button=s,t.dropdown_toggle=i}}]);
//# sourceMappingURL=ebcsv-view-cached-comics-view-e5e472d3f25c617c584b.js.map