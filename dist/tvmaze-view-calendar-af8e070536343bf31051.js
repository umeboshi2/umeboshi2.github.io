(window.webpackJsonp=window.webpackJsonp||[]).push([[48],{1190:function(s,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function s(s,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(s,n.key,n)}}return function(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),e}}(),j=u(t(37)),a=t(4),r=t(8),o=u(t(40)),i=u(t(106)),l=u(t(577));function u(s){return s&&s.__esModule?s:{default:s}}function c(s,e){if(!(s instanceof e))throw new TypeError("Cannot call a class as a function")}function d(s,e){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?s:e}t(1191),t(1230);var f,h,m,b,p,v,g;m=a.Radio.channel("global"),f=a.Radio.channel("tvmaze"),b=o.default.renderable((function(){return o.default.div(".listview-header","Episodes"),o.default.div(".loading",(function(){return o.default.h2((function(){return o.default.i(".fa.fa-spinner.fa-spin"),o.default.text("Loading Episodes")}))})),o.default.div(".maincalendar")})),g=function(s,e){return s.url="#tvmaze/shows/view/"+s.showId,e.css({cursor:"pointer","font-size":"0.9em","font-family":"Rambla"})},v=function(s){var e,t;return t=(0,j.default)(".loading"),e=(0,j.default)(".fc-toolbar"),s?(t.show(),e.hide()):(t.hide(),e.show())},p=function(s,e,t,n){var j,r,o,u,c,d;return d=(j=m.request("main:app:dbConn","tvmaze")).getSchema().table("TVMazeEpisode"),o=[],window.startMoment=s,c=s.toDate(),r=e.toDate(),o.push(d.airdate.gte(s)),o.push(d.airdate.lte(e)),u=j.select().from(d).where(i.default.op.and(d.airdate.gte(s.toDate()),d.airdate.lte(e.toDate()))),console.log("Q",u,c,r),u=u.exec(),console.log("Q",u),u.then((function(s){var e,t,j;return console.log("RESULTS",s),(e=new a.Collection).set(s),t=e.toJSON(),console.log("collection",e),j=[],t.forEach((function(s){var e,t,n;return e=(0,l.default)(s.airdate),n=s.runtime||30,t={id:s.id,showId:s.show_id,title:s.name,allDay:!1,start:e,end:e.add(n,"minutes"),url:"#tvmaze/shows/view/"+s.show_id},j.push(t)})),n(j)}))},h=function(){var s=function(s){function e(){c(this,e);var s=d(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments));return s.calendarViewRender=s.calendarViewRender.bind(s),s}return function(s,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):s.__proto__=e)}(e,s),n(e,[{key:"onBeforeDestroy",value:function(){this.ui.calendar.fullCalendar("destroy")}},{key:"calendarViewRender",value:function(s,t){return function(s,e){if(!(s instanceof e))throw new Error("Bound instance method accessed before binding")}(this,e),f.request("maincalendar:set-date",this.ui.calendar)}},{key:"onDomRefresh",value:function(){var s,e,t=this;return s=function(s){var e,n;return t.options.minicalendar?(e={layout:t.options.layout,region:"episode",id:s.id},f.request("view-episode",e)):(n=s.url,console.log("EVENT URL",s,n),a.history.navigate(n,{trigger:!0}))},e=f.request("maincalendar:get-date"),this.ui.calendar.fullCalendar({defaultDate:e,header:{left:"prevYear, nextYear",center:"title",right:"prev, next"},theme:!1,defaultView:"month",eventSources:[{events:p}],eventRender:g,viewRender:this.calendarViewRender,loading:v,eventClick:s}),console.log("we should either be fetching events, or refetching")}}]),e}(r.View);return s.prototype.template=b,s.prototype.ui={calendar:".maincalendar",loading:".loading",header:".fc-toolbar",daytop:".fc-day-top"},s.prototype.options={minicalendar:!1,layout:!1},s}.call(void 0),e.default=h},1192:function(s,e,t){var n={"./af":844,"./af.js":844,"./ar":845,"./ar-dz":846,"./ar-dz.js":846,"./ar-kw":847,"./ar-kw.js":847,"./ar-ly":848,"./ar-ly.js":848,"./ar-ma":849,"./ar-ma.js":849,"./ar-sa":850,"./ar-sa.js":850,"./ar-tn":851,"./ar-tn.js":851,"./ar.js":845,"./az":852,"./az.js":852,"./be":853,"./be.js":853,"./bg":854,"./bg.js":854,"./bm":855,"./bm.js":855,"./bn":856,"./bn.js":856,"./bo":857,"./bo.js":857,"./br":858,"./br.js":858,"./bs":859,"./bs.js":859,"./ca":860,"./ca.js":860,"./cs":861,"./cs.js":861,"./cv":862,"./cv.js":862,"./cy":863,"./cy.js":863,"./da":864,"./da.js":864,"./de":865,"./de-at":866,"./de-at.js":866,"./de-ch":867,"./de-ch.js":867,"./de.js":865,"./dv":868,"./dv.js":868,"./el":869,"./el.js":869,"./en-au":870,"./en-au.js":870,"./en-ca":871,"./en-ca.js":871,"./en-gb":872,"./en-gb.js":872,"./en-ie":873,"./en-ie.js":873,"./en-il":874,"./en-il.js":874,"./en-in":875,"./en-in.js":875,"./en-nz":876,"./en-nz.js":876,"./en-sg":877,"./en-sg.js":877,"./eo":878,"./eo.js":878,"./es":879,"./es-do":880,"./es-do.js":880,"./es-us":881,"./es-us.js":881,"./es.js":879,"./et":882,"./et.js":882,"./eu":883,"./eu.js":883,"./fa":884,"./fa.js":884,"./fi":885,"./fi.js":885,"./fil":886,"./fil.js":886,"./fo":887,"./fo.js":887,"./fr":888,"./fr-ca":889,"./fr-ca.js":889,"./fr-ch":890,"./fr-ch.js":890,"./fr.js":888,"./fy":891,"./fy.js":891,"./ga":892,"./ga.js":892,"./gd":893,"./gd.js":893,"./gl":894,"./gl.js":894,"./gom-deva":895,"./gom-deva.js":895,"./gom-latn":896,"./gom-latn.js":896,"./gu":897,"./gu.js":897,"./he":898,"./he.js":898,"./hi":899,"./hi.js":899,"./hr":900,"./hr.js":900,"./hu":901,"./hu.js":901,"./hy-am":902,"./hy-am.js":902,"./id":903,"./id.js":903,"./is":904,"./is.js":904,"./it":905,"./it-ch":906,"./it-ch.js":906,"./it.js":905,"./ja":907,"./ja.js":907,"./jv":908,"./jv.js":908,"./ka":909,"./ka.js":909,"./kk":910,"./kk.js":910,"./km":911,"./km.js":911,"./kn":912,"./kn.js":912,"./ko":913,"./ko.js":913,"./ku":914,"./ku.js":914,"./ky":915,"./ky.js":915,"./lb":916,"./lb.js":916,"./lo":917,"./lo.js":917,"./lt":918,"./lt.js":918,"./lv":919,"./lv.js":919,"./me":920,"./me.js":920,"./mi":921,"./mi.js":921,"./mk":922,"./mk.js":922,"./ml":923,"./ml.js":923,"./mn":924,"./mn.js":924,"./mr":925,"./mr.js":925,"./ms":926,"./ms-my":927,"./ms-my.js":927,"./ms.js":926,"./mt":928,"./mt.js":928,"./my":929,"./my.js":929,"./nb":930,"./nb.js":930,"./ne":931,"./ne.js":931,"./nl":932,"./nl-be":933,"./nl-be.js":933,"./nl.js":932,"./nn":934,"./nn.js":934,"./oc-lnc":935,"./oc-lnc.js":935,"./pa-in":936,"./pa-in.js":936,"./pl":937,"./pl.js":937,"./pt":938,"./pt-br":939,"./pt-br.js":939,"./pt.js":938,"./ro":940,"./ro.js":940,"./ru":941,"./ru.js":941,"./sd":942,"./sd.js":942,"./se":943,"./se.js":943,"./si":944,"./si.js":944,"./sk":945,"./sk.js":945,"./sl":946,"./sl.js":946,"./sq":947,"./sq.js":947,"./sr":948,"./sr-cyrl":949,"./sr-cyrl.js":949,"./sr.js":948,"./ss":950,"./ss.js":950,"./sv":951,"./sv.js":951,"./sw":952,"./sw.js":952,"./ta":953,"./ta.js":953,"./te":954,"./te.js":954,"./tet":955,"./tet.js":955,"./tg":956,"./tg.js":956,"./th":957,"./th.js":957,"./tl-ph":958,"./tl-ph.js":958,"./tlh":959,"./tlh.js":959,"./tr":960,"./tr.js":960,"./tzl":961,"./tzl.js":961,"./tzm":962,"./tzm-latn":963,"./tzm-latn.js":963,"./tzm.js":962,"./ug-cn":964,"./ug-cn.js":964,"./uk":965,"./uk.js":965,"./ur":966,"./ur.js":966,"./uz":967,"./uz-latn":968,"./uz-latn.js":968,"./uz.js":967,"./vi":969,"./vi.js":969,"./x-pseudo":970,"./x-pseudo.js":970,"./yo":971,"./yo.js":971,"./zh-cn":972,"./zh-cn.js":972,"./zh-hk":973,"./zh-hk.js":973,"./zh-mo":974,"./zh-mo.js":974,"./zh-tw":975,"./zh-tw.js":975};function j(s){var e=a(s);return t(e)}function a(s){if(!t.o(n,s)){var e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}return n[s]}j.keys=function(){return Object.keys(n)},j.resolve=a,s.exports=j,j.id=1192},764:function(s,e,t){var n={"./af":599,"./af.js":599,"./ar":600,"./ar-dz":601,"./ar-dz.js":601,"./ar-kw":602,"./ar-kw.js":602,"./ar-ly":603,"./ar-ly.js":603,"./ar-ma":604,"./ar-ma.js":604,"./ar-sa":605,"./ar-sa.js":605,"./ar-tn":606,"./ar-tn.js":606,"./ar.js":600,"./az":607,"./az.js":607,"./be":608,"./be.js":608,"./bg":609,"./bg.js":609,"./bm":610,"./bm.js":610,"./bn":611,"./bn-bd":612,"./bn-bd.js":612,"./bn.js":611,"./bo":613,"./bo.js":613,"./br":614,"./br.js":614,"./bs":615,"./bs.js":615,"./ca":616,"./ca.js":616,"./cs":617,"./cs.js":617,"./cv":618,"./cv.js":618,"./cy":619,"./cy.js":619,"./da":620,"./da.js":620,"./de":621,"./de-at":622,"./de-at.js":622,"./de-ch":623,"./de-ch.js":623,"./de.js":621,"./dv":624,"./dv.js":624,"./el":625,"./el.js":625,"./en-au":626,"./en-au.js":626,"./en-ca":627,"./en-ca.js":627,"./en-gb":628,"./en-gb.js":628,"./en-ie":629,"./en-ie.js":629,"./en-il":630,"./en-il.js":630,"./en-in":631,"./en-in.js":631,"./en-nz":632,"./en-nz.js":632,"./en-sg":633,"./en-sg.js":633,"./eo":634,"./eo.js":634,"./es":635,"./es-do":636,"./es-do.js":636,"./es-mx":637,"./es-mx.js":637,"./es-us":638,"./es-us.js":638,"./es.js":635,"./et":639,"./et.js":639,"./eu":640,"./eu.js":640,"./fa":641,"./fa.js":641,"./fi":642,"./fi.js":642,"./fil":643,"./fil.js":643,"./fo":644,"./fo.js":644,"./fr":645,"./fr-ca":646,"./fr-ca.js":646,"./fr-ch":647,"./fr-ch.js":647,"./fr.js":645,"./fy":648,"./fy.js":648,"./ga":649,"./ga.js":649,"./gd":650,"./gd.js":650,"./gl":651,"./gl.js":651,"./gom-deva":652,"./gom-deva.js":652,"./gom-latn":653,"./gom-latn.js":653,"./gu":654,"./gu.js":654,"./he":655,"./he.js":655,"./hi":656,"./hi.js":656,"./hr":657,"./hr.js":657,"./hu":658,"./hu.js":658,"./hy-am":659,"./hy-am.js":659,"./id":660,"./id.js":660,"./is":661,"./is.js":661,"./it":662,"./it-ch":663,"./it-ch.js":663,"./it.js":662,"./ja":664,"./ja.js":664,"./jv":665,"./jv.js":665,"./ka":666,"./ka.js":666,"./kk":667,"./kk.js":667,"./km":668,"./km.js":668,"./kn":669,"./kn.js":669,"./ko":670,"./ko.js":670,"./ku":671,"./ku.js":671,"./ky":672,"./ky.js":672,"./lb":673,"./lb.js":673,"./lo":674,"./lo.js":674,"./lt":675,"./lt.js":675,"./lv":676,"./lv.js":676,"./me":677,"./me.js":677,"./mi":678,"./mi.js":678,"./mk":679,"./mk.js":679,"./ml":680,"./ml.js":680,"./mn":681,"./mn.js":681,"./mr":682,"./mr.js":682,"./ms":683,"./ms-my":684,"./ms-my.js":684,"./ms.js":683,"./mt":685,"./mt.js":685,"./my":686,"./my.js":686,"./nb":687,"./nb.js":687,"./ne":688,"./ne.js":688,"./nl":689,"./nl-be":690,"./nl-be.js":690,"./nl.js":689,"./nn":691,"./nn.js":691,"./oc-lnc":692,"./oc-lnc.js":692,"./pa-in":693,"./pa-in.js":693,"./pl":694,"./pl.js":694,"./pt":695,"./pt-br":696,"./pt-br.js":696,"./pt.js":695,"./ro":697,"./ro.js":697,"./ru":698,"./ru.js":698,"./sd":699,"./sd.js":699,"./se":700,"./se.js":700,"./si":701,"./si.js":701,"./sk":702,"./sk.js":702,"./sl":703,"./sl.js":703,"./sq":704,"./sq.js":704,"./sr":705,"./sr-cyrl":706,"./sr-cyrl.js":706,"./sr.js":705,"./ss":707,"./ss.js":707,"./sv":708,"./sv.js":708,"./sw":709,"./sw.js":709,"./ta":710,"./ta.js":710,"./te":711,"./te.js":711,"./tet":712,"./tet.js":712,"./tg":713,"./tg.js":713,"./th":714,"./th.js":714,"./tk":715,"./tk.js":715,"./tl-ph":716,"./tl-ph.js":716,"./tlh":717,"./tlh.js":717,"./tr":718,"./tr.js":718,"./tzl":719,"./tzl.js":719,"./tzm":720,"./tzm-latn":721,"./tzm-latn.js":721,"./tzm.js":720,"./ug-cn":722,"./ug-cn.js":722,"./uk":723,"./uk.js":723,"./ur":724,"./ur.js":724,"./uz":725,"./uz-latn":726,"./uz-latn.js":726,"./uz.js":725,"./vi":727,"./vi.js":727,"./x-pseudo":728,"./x-pseudo.js":728,"./yo":729,"./yo.js":729,"./zh-cn":730,"./zh-cn.js":730,"./zh-hk":731,"./zh-hk.js":731,"./zh-mo":732,"./zh-mo.js":732,"./zh-tw":733,"./zh-tw.js":733};function j(s){var e=a(s);return t(e)}function a(s){if(!t.o(n,s)){var e=new Error("Cannot find module '"+s+"'");throw e.code="MODULE_NOT_FOUND",e}return n[s]}j.keys=function(){return Object.keys(n)},j.resolve=a,s.exports=j,j.id=764}}]);
//# sourceMappingURL=tvmaze-view-calendar-af8e070536343bf31051.js.map