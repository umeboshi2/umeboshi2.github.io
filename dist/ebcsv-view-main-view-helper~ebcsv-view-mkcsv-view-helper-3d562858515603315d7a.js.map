{"version":3,"sources":["webpack:///./src/applets/ebcsv/views/comic-list.coffee","webpack:///./src/applets/ebcsv/views/comicjson.coffee","webpack:///./node_modules/tbirds/src/templates/forms.coffee","webpack:///./node_modules/imagesloaded/imagesloaded.js","webpack:///./node_modules/tbirds/src/templates/buttons.coffee","webpack:///./src/applets/ebcsv/views/base-masonry.coffee","webpack:///./src/applets/ebcsv/views/has-image-modal.coffee","webpack:///./src/applets/ebcsv/views/comic-entry.coffee"],"names":["Backbone","ComicCollectionView","ComicEntryView","ComicListView","EmptyView","HasLateImages","HasMasonryView","make_field_input","make_field_select","tc","__webpack_require__","Radio","channel","[object Object]","child","this","setMasonryLayout","Marionette","CollectionView","childView","emptyView","childViewTriggers","show:image","View","list","getOption","view","collection","showChildView","options","listContainer","regions","behaviors","behaviorClass","masonryOptions","gutter","isInitLayout","itemSelector","columnWidth","horizontalOrder","template","renderable","model","div","module","exports","IsEscapeModal","JView","JsonView","modal_close_button","default","expanded_view","json_view","collapse","ui","expand_btn","text","expand","console","log","toJSON","body","prepend","dom","main","mainsection","h3","series","displayname","issue","ul","li","close_btn","events","click @ui.expand_btn","form_group_input_div","login_form","make_field_textarea","make_login_form","name_content_form","_util_capitalize__WEBPACK_IMPORTED_MODULE_1__","teacup__WEBPACK_IMPORTED_MODULE_0___default","a","data","atts","input_type","selector","label","for","input_id","input_attributes","input","content","field","Object","name","placeholder","value","optlist","select","i","len","opt","results","length","option","selected","action","method","user","form","role","type","button","textarea","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","window","factory","undefined","EvEmitter","$","jQuery","extend","b","prop","arraySlice","Array","prototype","slice","ImagesLoaded","elem","onAlways","queryElem","document","querySelectorAll","elements","obj","isArray","call","makeArray","on","getImages","jqDeferred","Deferred","setTimeout","check","bind","error","create","images","forEach","addElementImages","nodeName","addImage","background","addElementBackgroundImages","nodeType","elementNodeTypes","childImgs","img","children","1","9","11","LoadingImage","Background","url","element","Image","style","getComputedStyle","reURL","matches","exec","backgroundImage","addBackground","loadingImage","push","_this","onProgress","image","message","progress","progressedCount","hasAnyBroken","once","complete","isLoaded","emitEvent","notify","debug","eventName","isComplete","jqMethod","getIsImageComplete","confirm","naturalWidth","proxyImage","addEventListener","src","handleEvent","event","onload","unbindEvents","onerror","removeEventListener","makeJQueryPlugin","fn","imagesLoaded","callback","promise","apply","divbutton","dropdown_toggle","navbar_collapse_button","spanbutton","teacup__WEBPACK_IMPORTED_MODULE_0__","n","component","attrs","renderContents","span","icon","data-dismiss","h4","target","data-toggle","data-target","href","Masonry","Behavior","container","masonry","items","reloadItems","layout","destroy","ref","setMasonry","afterDomRefresh","BaseModalView","HasImageModal","ImageModalView","MainChannel","request","image_src","AppChannel","ComicImageView","IFrameModalView","MessageChannel","boundMethodCheck","instance","Constructor","Error","replace","iframe","trigger","triggers","click @ui.image","_parse_html","info_btn","show","hide","tagName","preventDefault","Model","response","fetch","then","get","_show_comic_image","_get_comic_data","fail","urls","link","_handleComicImage","cb","xhr","URL","ajax","dataType","done","responseText","cdoc","e","links","parseHTML","rel","save","clzpage","set_local","_set_local_images_url","where","msg","_add_comic_to_db","u","pathname","h5","title","edition","strong","clz_link","item","click @ui.info_btn","click @ui.clz_link","mouseenter @ui.item","mouseleave @ui.item"],"mappings":"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","file":"ebcsv-view-main-view-helper~ebcsv-view-mkcsv-view-helper-3d562858515603315d7a.js","sourcesContent":["$ = require 'jquery'\nBackbone = require 'backbone'\nMarionette = require 'backbone.marionette'\nMasonry = require 'masonry-layout'\nimagesLoaded = require 'imagesloaded'\ntc = require 'teacup'\n\nEmptyView = require 'tbirds/views/empty'\nnavigate_to_url = require 'tbirds/util/navigate-to-url'\n{ make_field_input\n  make_field_select } = require 'tbirds/templates/forms'\n\nComicEntryView = require './comic-entry'\nHasMasonryView = require './base-masonry'\n\n\nMainChannel = Backbone.Radio.channel 'global'\nMessageChannel = Backbone.Radio.channel 'messages'\nAppChannel = Backbone.Radio.channel 'ebcsv'\n\n\nclass HasLateImages extends HasMasonryView\n  onChildviewShowImage: (child) ->\n    @setMasonryLayout()\n\nclass ComicCollectionView extends Backbone.Marionette.CollectionView\n  childView: ComicEntryView\n  emptyView: EmptyView\n  # relay show:image event to parent\n  childViewTriggers:\n    'show:image': 'show:image'\n    \nlistContainer = '#comiclist-container'\nclass ComicListView extends Backbone.Marionette.View\n  options:\n    listContainer: listContainer\n  ui: ->\n    list: @getOption 'listContainer'\n  regions:\n    list: '@ui.list'\n  behaviors:\n    HasLateImages:\n      behaviorClass: HasLateImages\n      listContainer: listContainer\n      masonryOptions:\n        gutter: 1\n        isInitLayout: false\n        itemSelector: '.item'\n        columnWidth: 10\n        horizontalOrder: false\n  template: tc.renderable (model) ->\n    tc.div '#comiclist-container'\n  onRender: ->\n    view = new ComicCollectionView\n      collection: @collection\n    @showChildView 'list', view\n    \nmodule.exports = ComicListView\n\n\n","_ = require 'underscore'\nBackbone = require 'backbone'\nMarionette = require 'backbone.marionette'\ntc = require 'teacup'\nJView = require 'json-view'\nrequire 'json-view/devtools.css'\nmarked = require 'marked'\n\n{ modal_close_button } = require 'tbirds/templates/buttons'\n\n# FIXME\nIsEscapeModal = require('tbirds/behaviors/is-escape-modal').default\n\nMainChannel = Backbone.Radio.channel 'global'\nAppChannel = Backbone.Radio.channel 'ebcsv'\n\nclass JsonView extends Backbone.Marionette.View\n  behaviors: [IsEscapeModal]\n  template: tc.renderable (model) ->\n    main = model.mainsection\n    tc.div '.modal-dialog', ->\n      tc.div '.modal-content', ->\n        tc.h3 \"#{main.series.displayname} ##{main.issue}\"\n        tc.div '.modal-body', ->\n          tc.div '.expand-button.btn.btn-default', 'Expand'\n          tc.div '.panel'\n        tc.div '.modal-footer', ->\n          tc.ul '.list-inline', ->\n            btnclass = 'btn.btn-default.btn-sm'\n            tc.li \"#close-modal\", ->\n              modal_close_button 'Close', 'check'\n  ui:\n    body: '.panel'\n    expand_btn: '.expand-button'\n    close_btn: '#close-modal div'\n  events:\n    'click @ui.expand_btn': 'expand_view'\n\n  expand_view: ->\n    if @expanded_view\n      @json_view.collapse true\n      @expanded_view = false\n      @ui.expand_btn.text 'Expand'\n    else\n      @json_view.expand true\n      @expanded_view = true\n      @ui.expand_btn.text 'Collapse'\n    \n  onDomRefresh: ->\n    console.log 'onDomRefresh->jsonview'\n    @expanded_view = false\n    @json_view = new JView @model.toJSON()\n    @ui.body.prepend @json_view.dom\n\n  #onBeforeDestroy: ->\n  #  @json_view.destroy()\n    \n\nmodule.exports = JsonView\n","import tc from 'teacup'\n\nimport capitalize from '../util/capitalize'\n\nif __useCssModules__\n  require \"../../sass/forms.scss\"\n\n########################################\n# Form Templates\n########################################\nform_group_input_div = tc.renderable (data) ->\n  tc.div '.form-group', ->\n    tc.label '.control-label',\n      for:data.input_id\n      data.label\n    selector = \"##{data.input_id}.form-control\"\n    atts = data.input_attributes\n    input_type = tc.input\n    if data?.input_type\n      input_type = tc[data.input_type]\n      input_type selector, atts, ->\n        tc.text data?.content\n    else\n      input_type selector, atts\n\nmake_field_input = (field) ->\n  tc.renderable (model) ->\n    form_group_input_div\n      input_id: \"input_#{field}\"\n      label: capitalize field\n      input_attributes:\n        name: field\n        placeholder: field\n        value: model[field]\n    \nmake_field_textarea = (field) ->\n  tc.renderable (model) ->\n    form_group_input_div\n      input_id: \"input_#{field}\"\n      input_type: 'textarea'\n      label: capitalize field\n      input_attributes:\n        name: field\n        placeholder: field\n      content: model[field]\n\nmake_field_select = (field, optlist) ->\n  tc.renderable (model) ->\n    tc.div '.form-group', ->\n      tc.label '.control-label',\n        for:\"select_#{field}\"\n      capitalize field\n    tc.select '.form-control', name:\"select_#{field}\", ->\n      for opt in optlist\n        if model[field] is opt\n          tc.option selected:null, value:opt, opt\n        else\n          tc.option value:opt, opt\n          \nmake_login_form = (action='/login', method='POST') ->\n  tc.renderable (user) ->\n    tc.form\n      role:'form'\n      method: method\n      action: action, ->\n        form_group_input_div\n          input_id: 'input_username'\n          label: 'User Name'\n          input_attributes:\n            name: 'username'\n            placeholder: 'User Name'\n        form_group_input_div\n          input_id: 'input_password'\n          label: 'Password'\n          input_attributes:\n            name: 'password'\n            type: 'password'\n            placeholder: 'Type your password here....'\n        tc.button '.btn.btn-secondary', type:'submit', 'login'\n\nlogin_form = make_login_form()\n\nname_content_form = tc.renderable (model) ->\n  form_group_input_div\n    input_id: 'input_name'\n    label: 'Name'\n    input_attributes:\n      name: 'name'\n      placeholder: 'Name'\n  form_group_input_div\n    input_id: 'input_content'\n    input_type: tc.textarea\n    label: 'Content'\n    input_attributes:\n      name: 'content'\n      placeholder: '...'\n  tc.input '.btn.btn-secondary.btn-sm', type:'submit', value:'Add'\n\n########################################\nexport {\n  form_group_input_div\n  make_field_input\n  make_field_textarea\n  make_field_select\n  make_login_form\n  login_form\n  name_content_form\n  }\n  \n","/*!\n * imagesLoaded v4.1.4\n * JavaScript is all like \"You images are done yet or what?\"\n * MIT License\n */\n\n( function( window, factory ) { 'use strict';\n  // universal module definition\n\n  /*global define: false, module: false, require: false */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n      'ev-emitter/ev-emitter'\n    ], function( EvEmitter ) {\n      return factory( window, EvEmitter );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('ev-emitter')\n    );\n  } else {\n    // browser global\n    window.imagesLoaded = factory(\n      window,\n      window.EvEmitter\n    );\n  }\n\n})( typeof window !== 'undefined' ? window : this,\n\n// --------------------------  factory -------------------------- //\n\nfunction factory( window, EvEmitter ) {\n\n'use strict';\n\nvar $ = window.jQuery;\nvar console = window.console;\n\n// -------------------------- helpers -------------------------- //\n\n// extend objects\nfunction extend( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n}\n\nvar arraySlice = Array.prototype.slice;\n\n// turn element or nodeList into an array\nfunction makeArray( obj ) {\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    return obj;\n  }\n\n  var isArrayLike = typeof obj == 'object' && typeof obj.length == 'number';\n  if ( isArrayLike ) {\n    // convert nodeList to array\n    return arraySlice.call( obj );\n  }\n\n  // array of single index\n  return [ obj ];\n}\n\n// -------------------------- imagesLoaded -------------------------- //\n\n/**\n * @param {Array, Element, NodeList, String} elem\n * @param {Object or Function} options - if function, use as callback\n * @param {Function} onAlways - callback function\n */\nfunction ImagesLoaded( elem, options, onAlways ) {\n  // coerce ImagesLoaded() without new, to be new ImagesLoaded()\n  if ( !( this instanceof ImagesLoaded ) ) {\n    return new ImagesLoaded( elem, options, onAlways );\n  }\n  // use elem as selector string\n  var queryElem = elem;\n  if ( typeof elem == 'string' ) {\n    queryElem = document.querySelectorAll( elem );\n  }\n  // bail if bad element\n  if ( !queryElem ) {\n    console.error( 'Bad element for imagesLoaded ' + ( queryElem || elem ) );\n    return;\n  }\n\n  this.elements = makeArray( queryElem );\n  this.options = extend( {}, this.options );\n  // shift arguments if no options set\n  if ( typeof options == 'function' ) {\n    onAlways = options;\n  } else {\n    extend( this.options, options );\n  }\n\n  if ( onAlways ) {\n    this.on( 'always', onAlways );\n  }\n\n  this.getImages();\n\n  if ( $ ) {\n    // add jQuery Deferred object\n    this.jqDeferred = new $.Deferred();\n  }\n\n  // HACK check async to allow time to bind listeners\n  setTimeout( this.check.bind( this ) );\n}\n\nImagesLoaded.prototype = Object.create( EvEmitter.prototype );\n\nImagesLoaded.prototype.options = {};\n\nImagesLoaded.prototype.getImages = function() {\n  this.images = [];\n\n  // filter & find items if we have an item selector\n  this.elements.forEach( this.addElementImages, this );\n};\n\n/**\n * @param {Node} element\n */\nImagesLoaded.prototype.addElementImages = function( elem ) {\n  // filter siblings\n  if ( elem.nodeName == 'IMG' ) {\n    this.addImage( elem );\n  }\n  // get background image on element\n  if ( this.options.background === true ) {\n    this.addElementBackgroundImages( elem );\n  }\n\n  // find children\n  // no non-element nodes, #143\n  var nodeType = elem.nodeType;\n  if ( !nodeType || !elementNodeTypes[ nodeType ] ) {\n    return;\n  }\n  var childImgs = elem.querySelectorAll('img');\n  // concat childElems to filterFound array\n  for ( var i=0; i < childImgs.length; i++ ) {\n    var img = childImgs[i];\n    this.addImage( img );\n  }\n\n  // get child background images\n  if ( typeof this.options.background == 'string' ) {\n    var children = elem.querySelectorAll( this.options.background );\n    for ( i=0; i < children.length; i++ ) {\n      var child = children[i];\n      this.addElementBackgroundImages( child );\n    }\n  }\n};\n\nvar elementNodeTypes = {\n  1: true,\n  9: true,\n  11: true\n};\n\nImagesLoaded.prototype.addElementBackgroundImages = function( elem ) {\n  var style = getComputedStyle( elem );\n  if ( !style ) {\n    // Firefox returns null if in a hidden iframe https://bugzil.la/548397\n    return;\n  }\n  // get url inside url(\"...\")\n  var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\n  var matches = reURL.exec( style.backgroundImage );\n  while ( matches !== null ) {\n    var url = matches && matches[2];\n    if ( url ) {\n      this.addBackground( url, elem );\n    }\n    matches = reURL.exec( style.backgroundImage );\n  }\n};\n\n/**\n * @param {Image} img\n */\nImagesLoaded.prototype.addImage = function( img ) {\n  var loadingImage = new LoadingImage( img );\n  this.images.push( loadingImage );\n};\n\nImagesLoaded.prototype.addBackground = function( url, elem ) {\n  var background = new Background( url, elem );\n  this.images.push( background );\n};\n\nImagesLoaded.prototype.check = function() {\n  var _this = this;\n  this.progressedCount = 0;\n  this.hasAnyBroken = false;\n  // complete if no images\n  if ( !this.images.length ) {\n    this.complete();\n    return;\n  }\n\n  function onProgress( image, elem, message ) {\n    // HACK - Chrome triggers event before object properties have changed. #83\n    setTimeout( function() {\n      _this.progress( image, elem, message );\n    });\n  }\n\n  this.images.forEach( function( loadingImage ) {\n    loadingImage.once( 'progress', onProgress );\n    loadingImage.check();\n  });\n};\n\nImagesLoaded.prototype.progress = function( image, elem, message ) {\n  this.progressedCount++;\n  this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;\n  // progress event\n  this.emitEvent( 'progress', [ this, image, elem ] );\n  if ( this.jqDeferred && this.jqDeferred.notify ) {\n    this.jqDeferred.notify( this, image );\n  }\n  // check if completed\n  if ( this.progressedCount == this.images.length ) {\n    this.complete();\n  }\n\n  if ( this.options.debug && console ) {\n    console.log( 'progress: ' + message, image, elem );\n  }\n};\n\nImagesLoaded.prototype.complete = function() {\n  var eventName = this.hasAnyBroken ? 'fail' : 'done';\n  this.isComplete = true;\n  this.emitEvent( eventName, [ this ] );\n  this.emitEvent( 'always', [ this ] );\n  if ( this.jqDeferred ) {\n    var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\n    this.jqDeferred[ jqMethod ]( this );\n  }\n};\n\n// --------------------------  -------------------------- //\n\nfunction LoadingImage( img ) {\n  this.img = img;\n}\n\nLoadingImage.prototype = Object.create( EvEmitter.prototype );\n\nLoadingImage.prototype.check = function() {\n  // If complete is true and browser supports natural sizes,\n  // try to check for image status manually.\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    // report based on naturalWidth\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    return;\n  }\n\n  // If none of the checks above matched, simulate loading on detached element.\n  this.proxyImage = new Image();\n  this.proxyImage.addEventListener( 'load', this );\n  this.proxyImage.addEventListener( 'error', this );\n  // bind to image as well for Firefox. #191\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.proxyImage.src = this.img.src;\n};\n\nLoadingImage.prototype.getIsImageComplete = function() {\n  // check for non-zero, non-undefined naturalWidth\n  // fixes Safari+InfiniteScroll+Masonry bug infinite-scroll#671\n  return this.img.complete && this.img.naturalWidth;\n};\n\nLoadingImage.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.img, message ] );\n};\n\n// ----- events ----- //\n\n// trigger specified handler for event type\nLoadingImage.prototype.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\nLoadingImage.prototype.onload = function() {\n  this.confirm( true, 'onload' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.onerror = function() {\n  this.confirm( false, 'onerror' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.unbindEvents = function() {\n  this.proxyImage.removeEventListener( 'load', this );\n  this.proxyImage.removeEventListener( 'error', this );\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\n// -------------------------- Background -------------------------- //\n\nfunction Background( url, element ) {\n  this.url = url;\n  this.element = element;\n  this.img = new Image();\n}\n\n// inherit LoadingImage prototype\nBackground.prototype = Object.create( LoadingImage.prototype );\n\nBackground.prototype.check = function() {\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.img.src = this.url;\n  // check if image is already complete\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    this.unbindEvents();\n  }\n};\n\nBackground.prototype.unbindEvents = function() {\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\nBackground.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.element, message ] );\n};\n\n// -------------------------- jQuery -------------------------- //\n\nImagesLoaded.makeJQueryPlugin = function( jQuery ) {\n  jQuery = jQuery || window.jQuery;\n  if ( !jQuery ) {\n    return;\n  }\n  // set local variable\n  $ = jQuery;\n  // $().imagesLoaded()\n  $.fn.imagesLoaded = function( options, callback ) {\n    var instance = new ImagesLoaded( this, options, callback );\n    return instance.jqDeferred.promise( $(this) );\n  };\n};\n// try making plugin\nImagesLoaded.makeJQueryPlugin();\n\n// --------------------------  -------------------------- //\n\nreturn ImagesLoaded;\n\n});\n","import tc from 'teacup'\n\n\n########################################\n# Button Templates\n########################################\nspanbutton = tc.component (selector, attrs, renderContents) ->\n  tc.span \"#{selector}.btn.btn-secondary.btn-sm\", renderContents\n\ndivbutton = tc.component (selector, attrs, renderContents) ->\n  tc.div \"#{selector}.btn.btn-secondary.btn-sm\", renderContents\n\nmodal_close_button = tc.renderable (label='Close', icon='close')->\n  tc.div '.btn.btn-secondary.btn-sm', 'data-dismiss': 'modal', ->\n    tc.h4 '.modal-title', ->\n      tc.i \".fa.fa-#{icon}\"\n      tc.text label\n\nnavbar_collapse_button  = tc.renderable (target) ->\n  tc.button '.navbar-toggle', type:'button', 'data-toggle':'collapse',\n  'data-target': \"##{target}\", ->\n    tc.span '.sr-only', 'Toggle Navigation'\n    tc.span '.icon-bar'\n    tc.span '.icon-bar'\n    tc.span '.icon-bar'\n\ndropdown_toggle = tc.component (selector, attrs, renderContents) ->\n  tc.a \"#{selector}.dropdown-toggle\", href:attrs.href,\n  'data-toggle':'dropdown', renderContents\n\nexport {\n  spanbutton\n  divbutton\n  modal_close_button\n  navbar_collapse_button\n  dropdown_toggle\n  }\n  \n","Backbone = require 'backbone'\nMarionette = require 'backbone.marionette'\nMasonry = require 'masonry-layout'\nimagesLoaded = require 'imagesloaded'\n\nclass HasMasonryView extends Marionette.Behavior\n  options:\n    listContainer: '.list-container'\n    channel: 'global'\n    masonryOptions:\n      gutter: 1\n      isInitLayout: false\n      itemSelector: '.item'\n      columnWidth: 10\n      horizontalOrder: true\n  ui: ->\n    list: @getOption 'listContainer'\n  regions:\n    list: '@ui.list'\n    \n  setMasonry: ->\n    container = @getOption 'listContainer'\n    masonryOptions = @getOption 'masonryOptions'\n    @view.masonry = new Masonry container, masonryOptions\n    \n  setMasonryLayout: ->\n    masonryOptions = @getOption 'masonryOptions'\n    items = @$ masonryOptions.itemSelector\n    imagesLoaded items, =>\n      @view.masonry.reloadItems()\n      @view.masonry.layout()\n\n  onBeforeDestroy: ->\n    @view.masonry.destroy()\n    \n  onDomRefresh: () ->\n    @setMasonry()\n    @setMasonryLayout()\n    if @view?.afterDomRefresh\n      @view.afterDomRefresh()\n    \n  \nmodule.exports = HasMasonryView\n","Backbone = require 'backbone'\nMarionette = require 'backbone.marionette'\ntc = require 'teacup'\n\n{ make_field_input\n  make_field_select } = require 'tbirds/templates/forms'\n{ modal_close_button } = require 'tbirds/templates/buttons'\n\nMainChannel = Backbone.Radio.channel 'global'\nMessageChannel = Backbone.Radio.channel 'messages'\nAppChannel = Backbone.Radio.channel 'ebcsv'\n\nBaseModalView = MainChannel.request 'main:app:BaseModalView'\n\nclass ImageModalView extends BaseModalView\n  template: tc.renderable (model) ->\n    main = model.mainsection\n    tc.div '.modal-dialog', ->\n      tc.div '.modal-content', ->\n        tc.div '.modal-body', ->\n          tc.img src: model.image_src\n        tc.div '.modal-footer', ->\n          tc.ul '.list-inline', ->\n            btnclass = 'btn.btn-default.btn-sm'\n            tc.li \"#close-modal\", ->\n              modal_close_button 'Close', 'check'\n\nclass HasImageModal extends Marionette.Behavior\n  onShowImageModal: ->\n    view = new ImageModalView\n      model: @view.model\n    MainChannel.request 'show-modal', view\n\n    \nmodule.exports = HasImageModal\n","$ = require 'jquery'\nBackbone = require 'backbone'\nMarionette = require 'backbone.marionette'\nMasonry = require 'masonry-layout'\ntc = require 'teacup'\n\nnavigate_to_url = require 'tbirds/util/navigate-to-url'\n{ make_field_input\n  make_field_select } = require 'tbirds/templates/forms'\n{ modal_close_button } = require 'tbirds/templates/buttons'\n\nJsonView = require './comicjson'\nHasImageModal = require './has-image-modal'\n\nMainChannel = Backbone.Radio.channel 'global'\nMessageChannel = Backbone.Radio.channel 'messages'\nAppChannel = Backbone.Radio.channel 'ebcsv'\n\nBaseModalView = MainChannel.request 'main:app:BaseModalView'\n\nclass IFrameModalView extends BaseModalView\n  template: tc.renderable (model) ->\n    main = model.mainsection\n    tc.div '.modal-dialog.modal-lg', ->\n      tc.div '.modal-content', ->\n        tc.div '.modal-body', ->\n          src = model.src.replace 'http://', '//'\n          tc.iframe style:\"width:97%;height:75vh;\", src: src\n        tc.div '.modal-footer', ->\n          tc.ul '.list-inline', ->\n            btnclass = 'btn.btn-default.btn-sm'\n            tc.li \"#close-modal\", ->\n              modal_close_button 'Close', 'check'\n              \n\n########################################\nclass ComicImageView extends Backbone.Marionette.View\n  template: tc.renderable (model) ->\n    img = model.image_src.replace '/lg/', '/sm/'\n    img = img.replace 'http://', '//'\n    tc.img src:img\n  ui:\n    image: 'img'\n  triggers:\n    'click @ui.image': 'show:image:modal'\n  behaviors: [HasImageModal]\n  onDomRefresh: ->\n    @trigger 'show:image'\n    \nclass ComicEntryView extends Backbone.Marionette.View\n  template: tc.renderable (model) ->\n    main = model.mainsection\n    tc.div '.item.listview-list-entry.thumbnail.col-md-2', ->\n      tc.div '.comic-image', ->\n        tc.i '.fa.fa-spinner.fa-spin'\n        tc.text 'loading'\n      tc.div '.caption', ->\n        tc.span ->\n          tc.i '.info-button.fa.fa-info.fa-pull-left.btn.btn-default.btn-sm'\n          tc.h5 style:\"text-overflow: ellipsis;\",\n          \"#{main.series.displayname} ##{model.issue}\"\n        label = main?.title or model?.edition?.displayname\n        label = label or tc.strong 'UNTITLED'\n        tc.a '.clz-link',\n        href:\"#{model.links.link.url}\", target:'_blank', label\n  ui:\n    info_btn: '.info-button'\n    clz_link: '.clz-link'\n    item: '.item'\n    image: '.comic-image'\n  regions:\n    image: '@ui.image'\n  events:\n    'click @ui.info_btn': 'show_comic_json'\n    'click @ui.clz_link': 'show_comic_page'\n    'mouseenter @ui.item': 'mouse_enter_item'\n    'mouseleave @ui.item': 'mouse_leave_item'\n  # relay show:image event to parent\n  childViewTriggers:\n    'show:image': 'show:image'\n    \n  mouse_enter_item: (event) ->\n    @ui.info_btn.show()\n  mouse_leave_item: (event) ->\n    @ui.info_btn.hide()\n    \n  show_comic_json: (event) ->\n    target = event.target\n    if target.tagName is \"A\"\n      return\n    view = new JsonView\n      model: @model\n    MainChannel.request 'show-modal', view\n\n  show_comic_page: (event) ->\n    event.preventDefault()\n    target = event.target\n    if target.tagName is \"A\"\n      view = new IFrameModalView\n        model: new Backbone.Model src:target.href\n      MainChannel.request 'show-modal', view\n      \n  _handleComicImage: (url) ->\n    Model = AppChannel.request 'get-comic-url-model'\n    model = new Model\n      url: url\n    response = model.fetch\n      data:\n        url: url\n    response.then (results) =>\n      imageSrc = model.get 'image_src'\n      if not imageSrc\n        @_get_comic_data url, @_parse_html\n      else\n        @_show_comic_image model, false\n    response.fail =>\n      @_get_comic_data url, @_parse_html\n    return\n\n  _handleLocalUrls: (url) ->\n    urls = AppChannel.request 'get-comic-image-urls'\n    if urls[url]\n      model = new Backbone.Model\n        image_src: urls[url]\n        url: url\n      @_show_comic_image model, false\n    else\n      #@_get_comic_from_db()\n      if url\n        @_get_comic_data url, @_parse_html\n    \n  onDomRefresh: ->\n    @ui.info_btn.hide()\n    links = @model.get 'links'\n    url = links.link.url\n    #console.log \"Links\", links\n    #console.log \"Link url\", url\n    #@_handleLocalUrls url\n    @_handleComicImage url\n    \n  _get_comic_data: (url, cb) ->\n    console.log \"_get_comic_data\", url\n    u = new URL url\n    xhr = Backbone.ajax\n      type: 'GET'\n      dataType: 'html'\n      # https://stackoverflow.com/a/17299796/1869821\n      url: \"//cors-anywhere.herokuapp.com/#{url}\"\n    xhr.done ->\n      cb url, xhr.responseText\n    xhr.fail ->\n      MessageChannel.request 'warning', \"Couldn't get the info\"\n\n  _parse_html: (url, content) =>\n    cdoc = $.parseHTML content\n    links = []\n    for e in cdoc\n      if e.tagName == 'LINK' and e.rel == 'image_src'\n        links.push e\n    if links.length > 1\n      MessageChannel.request 'warning', 'Too many links for this comic.'\n    link = links[0]\n    image_src = link.href\n    #AppChannel.request 'add-comic-image-url', url, image_src\n    Model = AppChannel.request 'get-comic-url-model'\n    model = new Model\n      url: url\n      image_src: image_src\n    response = model.save()\n    response.done =>\n      @_show_comic_image model, false\n      \n  _set_local_images_url: (clzpage) ->\n    url = clzpage.get 'url'\n    image_src = clzpage.get 'image_src'\n    \n  _show_comic_image: (clzpage, set_local=true) ->\n    if set_local then @_set_local_images_url clzpage\n    view = new ComicImageView\n      model: clzpage\n    @showChildView 'image', view\n    \n  show_comic: ->\n    links = @model.get 'links'\n    url = links.link.url\n    u = new URL url\n    collection = AppChannel.request 'clzpage-collection'\n    response = collection.fetch\n      data:\n        where:\n          url: url\n    response.fail ->\n      msg = \"There was a problem talking to the server\"\n      MessageChannel.request 'warning', msg\n    response.done =>\n      if collection.length > 1\n        MessageChannel.request 'warning', \"#{url} is not unique!\"\n      if not collection.length\n        @_get_comic_data url, @_add_comic_to_db\n      \n\n  get_comic_data: (url) ->\n    u = new URL url\n    xhr = Backbone.ajax\n      type: 'GET'\n      dataType: 'html'\n      url: \"/clzcore#{u.pathname}\"\n    xhr.done =>\n      view = new Backbone.Marionette.View\n        template: xhr.responseText\n      @showChildView 'info', view\n    xhr.fail ->\n      MessageChannel.request 'warning', \"Couldn't get the info\"\n  \nmodule.exports = ComicEntryView\n\n\n"],"sourceRoot":""}