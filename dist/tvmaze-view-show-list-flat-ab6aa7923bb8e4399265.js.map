{"version":3,"sources":["webpack:///./src/applets/tvmaze/views/flat-show-list.coffee","webpack:///./node_modules/tbirds/src/views/paginate-bar.coffee","webpack:///./src/applets/tvmaze/views/confirm-delete-modal.coffee"],"names":["Backbone","ConfirmDeleteModal","ItemCollectionView","ItemView","ListView","MainChannel","Marionette","PaginateBar","itemTemplate","listTemplate","marked","navigate_to_url","tc","view_template","__webpack_require__","default","Radio","channel","renderable","model","li","span","a","href","id","content","name","button","style","console","log","collection","state","totalPages","firstPage","lastPage","div","text","nav","ul","View","[object Object]","event","preventDefault","this","view","backdrop","modal_region","request","getView","getRegion","show","_show_modal","template","ui","item","link","deleteItem","events","click @ui.link","click @ui.deleteItem","CollectionView","childView","showChildView","header","paginateBar","itemList","regions","raw","appName","MainView","templateContext","module","exports","teacup__WEBPACK_IMPORTED_MODULE_3__","teacup__WEBPACK_IMPORTED_MODULE_3___default","n","boundMethodCheck","instance","Constructor","Error","backbone__WEBPACK_IMPORTED_MODULE_1___default","__webpack_exports__","PaginationView","backbone_marionette__WEBPACK_IMPORTED_MODULE_2___default","keydownHandler","bind","updateNavButtons","pageNumber","jquery__WEBPACK_IMPORTED_MODULE_0___default","target","attr","getPage","Number","cp","nextItem","prevItem","prevButton","parent","currentPage","hasClass","addClass","removeClass","nextButton","numberedPage","direction","onFirstPage","onLastPage","resp","getNextPage","getPreviousPage","getAnotherPage","getOption","onRenderHandleKeys","onBeforeDestroyHandleKeys","command","key","ref","results","value","keycommands","keyCode","handleKeyCommand","keydown","unbind","tagName","className","i","p","ref1","Collection","data","click @ui.numberedPage","click @ui.prevButton","click @ui.nextButton","prev","next","ConfirmDeleteTemplate","MessageChannel","teacup__WEBPACK_IMPORTED_MODULE_2__","teacup__WEBPACK_IMPORTED_MODULE_2___default","backbone__WEBPACK_IMPORTED_MODULE_0___default","h3","img","src","image","medium","type","dismiss","aria-hidden","backbone_marionette__WEBPACK_IMPORTED_MODULE_1___default","click @ui.confirmDelete","response","get","destroy","done","fail","confirmDelete","cancelButton"],"mappings":"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","file":"tvmaze-view-show-list-flat-ab6aa7923bb8e4399265.js","sourcesContent":["$ = require 'jquery'\nBackbone = require 'backbone'\nMarionette = require 'backbone.marionette'\ntc = require 'teacup'\nmarked = require 'marked'\n\nnavigate_to_url = require('tbirds/util/navigate-to-url').default\nPaginateBar = require('tbirds/views/paginate-bar').default\n\nConfirmDeleteModal = require('./confirm-delete-modal').default\n\nMainChannel = Backbone.Radio.channel 'global'\nMessageChannel = Backbone.Radio.channel 'messages'\n\n\n\n\nitemTemplate = tc.renderable (model) ->\n  itemBtn = '.btn.btn-sm'\n  tc.li '.list-group-item', ->\n    tc.span ->\n      tc.a href:\"#tvmaze/view/show/#{model.id}\", model.content.name\n    tc.span '.btn-group.pull-right', ->\n      tc.button '.delete-item.btn.btn-sm.btn-danger.fa.fa-close',\n      style:'display:none', 'delete'\n    \nlistTemplate = tc.renderable (model) ->\n  console.log \"listTemplate\", model\n  totalPages = model.collection.state.totalPages\n  firstPage = model.collection.state.firstPage\n  lastPage = model.collection.state.lastPage\n  tc.div '.listview-header', ->\n    tc.text \"TV Shows\"\n  tc.nav '.paginate-bar'\n  tc.ul \".list-group\"\n\n\nclass ItemView extends Marionette.View\n  template: itemTemplate\n  ui:\n    item: '.list-group-item'\n    link: 'a'\n    deleteItem: '.delete-item'\n  events:\n    'click @ui.link': 'showRole'\n    'click @ui.deleteItem': 'deleteItem'\n  showRole: (event) ->\n    event.preventDefault()\n    navigate_to_url \"#tvmaze/shows/view/#{@model.id}\"\n  _show_modal: (view, backdrop) ->\n    app = MainChannel.request 'main:app:object'\n    layout = app.getView()\n    modal_region = layout.getRegion 'modal'\n    modal_region.backdrop = backdrop\n    modal_region.show view\n  deleteItem: ->\n    view = new ConfirmDeleteModal\n      model: @model\n    @_show_modal view, true\n    \nclass ItemCollectionView extends Marionette.CollectionView\n  childView: ItemView\n\nclass ListView extends Marionette.View\n  template: listTemplate\n  templateContext: ->\n    collection: @collection\n  ui:\n    header: '.listview-header'\n    paginateBar: '.paginate-bar'\n    itemList: '.list-group'\n  regions:\n    paginateBar: '@ui.paginateBar'\n    itemList: '@ui.itemList'\n  onRender: ->\n    view = new ItemCollectionView\n      collection: @collection\n    @showChildView 'itemList', view\n    view = new PaginateBar\n      collection: @collection\n    @showChildView 'paginateBar', view\n    \nview_template = tc.renderable (model) ->\n  tc.div '.row.listview-list-entry', ->\n    tc.raw marked \"# #{model.appName} started.\"\n    \nclass MainView extends Marionette.View\n  template: view_template\n  templateContext:\n    appName: 'tvmaze'\n    \nmodule.exports = ListView\n\n","import $ from 'jquery'\nimport Backbone from 'backbone'\nimport Marionette from 'backbone.marionette'\nimport tc from 'teacup'\n\nMainChannel = Backbone.Radio.channel 'global'\nMessageChannel = Backbone.Radio.channel 'messages'\n\n# this needs to be contained in a 'nav' region\nexport default class PaginationView extends Marionette.View\n  tagName: 'ul'\n  className: 'pagination'\n  template: tc.renderable (model) ->\n    if model instanceof Backbone.Collection\n      state = model.state\n    else\n      state = model.collection.state\n    totalPages = state.totalPages\n    firstPage = state.firstPage\n    lastPage = state.lastPage\n    tc.li '.page-item', ->\n      tc.a '.prev.page-link.bg-body-d5', ->\n        tc.i '.fa.fa-arrow-left'\n    for p in [firstPage..lastPage]\n      tc.li '.page-item', ->\n        tc.a '.numbered-page.page-link.bg-body-d5.text-dark',\n        href:'#', data: pageNumber: p, p\n    tc.li '.page-item', ->\n      tc.a '.next.page-link.bg-body-d5', ->\n        tc.i '.fa.fa-arrow-right'\n  templateContext: ->\n    collection: @collection\n  ui:\n    numberedPage: '.numbered-page'\n    prevButton: '.prev'\n    nextButton: '.next'\n  events:\n    'click @ui.numberedPage': 'turnPage'\n    'click @ui.prevButton': 'getPreviousPage'\n    'click @ui.nextButton': 'getNextPage'\n  onDomRefresh: ->\n    @updateNavButtons()\n  turnPage: (event) ->\n    event.preventDefault()\n    el = $(event.target)\n    pageNumber = el.attr 'data-pagenumber'\n    @collection.getPage Number pageNumber\n    @updateNavButtons()\n\n  updateNavButtons: ->\n    state = @collection.state\n    prevItem = @ui.prevButton.parent()\n    if state.currentPage == state.firstPage\n      unless prevItem.hasClass 'disabled'\n        prevItem.addClass 'disabled'\n    else\n      if prevItem.hasClass 'disabled'\n        prevItem.removeClass 'disabled'\n    nextItem = @ui.nextButton.parent()\n    if state.currentPage == state.lastPage\n      unless nextItem.hasClass 'disabled'\n        nextItem.addClass 'disabled'\n    else\n      if nextItem.addClass 'disabled'\n        nextItem.removeClass 'disabled'\n    @ui.numberedPage.parent().removeClass 'active'\n    @ui.numberedPage.removeClass 'text-white'\n    @ui.numberedPage.addClass 'text-dark'\n    cp = $(\"[data-pagenumber=\\\"#{state.currentPage}\\\"]\")\n    cpp = cp.parent()\n    cpp.addClass 'active'\n    cp.removeClass 'text-dark'\n    cp.addClass 'text-white'\n\n  getAnotherPage: (direction) ->\n    state = @collection.state\n    onLastPage = state.currentPage == state.lastPage\n    # we need this in case the pages start at zero\n    onFirstPage = state.currentPage == state.firstPage\n    if direction is 'prev' and not onFirstPage\n      if state.currentPage != state.firstPage\n        resp = @collection.getPreviousPage()\n    else if direction is 'next' and not onLastPage\n      resp = @collection.getNextPage()\n    else if onLastPage\n      return\n    else\n      throw new Error \"bad direction '#{direction}'\"\n    @updateNavButtons()\n    return resp\n    \n  getPreviousPage: ->\n    return @getAnotherPage 'prev'\n      \n  getNextPage: ->\n    return @getAnotherPage 'next'\n      \n  onRender: ->\n    setKeyHandler = @getOption 'setKeyHandler'\n    if setKeyHandler\n      @onRenderHandleKeys()\n      \n  onBeforeDestroy: ->\n    setKeyHandler = @getOption 'setKeyHandler'\n    if setKeyHandler\n      @onBeforeDestroyHandleKeys()\n    \n  keycommands:\n    prev: 37\n    next: 39\n  handleKeyCommand: (command) ->\n    if command in ['prev', 'next']\n      @getAnotherPage command\n  keydownHandler: (event) =>\n    for key, value of @keycommands\n      if event.keyCode == value\n        @handleKeyCommand key\n\n  onRenderHandleKeys: ->\n    $(\"html\").keydown @keydownHandler\n\n  onBeforeDestroyHandleKeys: ->\n    $(\"html\").unbind 'keydown', @keydownHandler\n    \n","import Backbone from 'backbone'\nimport Marionette from 'backbone.marionette'\nimport tc from 'teacup'\n\nMessageChannel = Backbone.Radio.channel 'messages'\n\nConfirmDeleteTemplate = tc.renderable (model) ->\n  tc.div '.modal-content', ->\n    tc.div '.modal-header', ->\n      tc.h3 '.modal-title', ->\n        tc.text \"Do you really want to delete #{model.content.name}?\"\n        tc.img src:model.content.image.medium\n      tc.button '.close', type:'button', data:{dismiss:'modal'}, ->\n        tc.span \"aria-hidden\":\"true\", ->\n          tc.raw '&times'\n    tc.div '.modal-body', ->\n      tc.div '#selected-children'\n    tc.div '.modal-footer', ->\n      tc.button '.confirm-delete.btn.btn-primary',\n      type:'button', data:{dismiss:'modal'}, ->\n        tc.i '.fa.fa-check'\n        tc.text \"OK\"\n      tc.button '.cancel-delete.btn.btn-danger',\n      type:'button', data:{dismiss:'modal'}, ->\n        tc.i '.fa.fa-close'\n        tc.text \"Cancel\"\n\nexport default class ConfirmDeleteModal extends Marionette.View\n  template: ConfirmDeleteTemplate\n  className: 'modal-dialog'\n  ui:\n    confirmDelete: '.confirm-delete'\n    cancelButton: '.cancel-delete'\n    \n  events: ->\n    'click @ui.confirmDelete': 'confirmDelete'\n\n  confirmDelete: ->\n    name = @model.get 'name'\n    response = @model.destroy()\n    response.done ->\n      MessageChannel.request 'success', \"#{name} deleted.\",\n    response.fail ->\n      MessageChannel.request 'danger', \"#{name} NOT deleted.\"\n      \n"],"sourceRoot":""}