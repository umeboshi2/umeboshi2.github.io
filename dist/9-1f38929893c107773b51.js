(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{191:function(e,t,r){var n,o,s,a,i,l;n=r(2),r(3),l=r(0),n.Radio.channel("bumblr"),i=l.renderable(function(e){return l.p("main bumblr view")}),a=l.renderable(function(e){return l.p("bumblr_dashboard_view")}),s=function(){class e extends n.Marionette.View{}return e.prototype.template=i,e}.call(this),o=function(){class e extends n.Marionette.View{}return e.prototype.template=a,e}.call(this),e.exports={MainBumblrView:s,BumblrDashboardView:o}},41:function(e,t,r){"use strict";r.r(t);var n,o=r(3),s=r.n(o),a=r(61),i=r(4),l=r.n(i),c=r(2),u=r.n(c),d=(r(0),r(52)),h=(r(14),r(60)),b=(r(55),r(64)),f=r.n(b),p=r(59),g=r(7),m=r.n(g);u.a.Radio.channel("global"),u.a.Radio.channel("messages"),u.a.Radio.channel("resources"),n=function(){class e extends u.a.Collection{initialize(){return this.fetch(),this.on("change",this.save,this)}fetch(){var e;return e=JSON.parse(localStorage.getItem(this.local_storage_key))||[],this.set(e)}save(e){return localStorage.setItem(this.local_storage_key,JSON.stringify(this.toJSON()))}}return e.prototype.local_storage_key=null,e}.call(this),console.warn("Use a better model");var v,w,y,x,_,S,O,j,k,B,N,P,L,R,$=class extends c.Model{initialize(){return this.fetch(),this.on("change",this.save,this)}fetch(){return this.set(JSON.parse(localStorage.getItem(this.id)))}save(e,t){return localStorage.setItem(this.id,JSON.stringify(this.toJSON())),l.a.ajax({success:t.success,error:t.error})}destroy(e){return localStorage.removeItem(this.id)}isEmpty(){return m.a.size(this.attributes<=1)}};O=u.a.Radio.channel("global"),v=u.a.Radio.channel("bumblr"),B=O.request("main:app:dbConn","bumblr"),j="//api.tumblr.com/v2",x=function(){class e extends f.a{url(){return`${this.baseURL}/blog/${this.blogName}/posts/photo?api_key=${this.apiKey}`}fetch(e){return e||(e={}),e.data||{},this.state.currentPage,e.dataType="jsonp",super.fetch(e)}parse(e){var t;return console.log("PARSE",e),t=e.response.total_posts,this.state.totalRecords=t,super.parse(e.response.posts)}}return e.prototype.mode="server",e.prototype.full=!0,e.prototype.baseURL=j,e.prototype.state={firstPage:0,pageSize:15},e.prototype.queryParams={pageSize:"limit",offset:function(){return this.state.currentPage*this.state.pageSize}},e}.call(this),w=function(){class e extends u.a.Model{}return e.prototype.baseURL=j,e}.call(this),y=class extends w{url(){return`${this.baseURL}/blog/${this.id}/info?api_key=${this.apiKey}&callback=?`}},_=function(){class e extends ${}return e.prototype.id="bumblr_settings",e}.call(this),P=new _,v.reply("get_app_settings",function(){return P}),k="4mhV8B1YQK6PUA2NW8eZZXVHjU55TPJ3UZnZGrbSoCnqJaxDyH",P.get("consumer_key")||(console.log("saving initial app settings"),P.set("consumer_key",k),P.save()),new p.LoveStore(B,"Blog"),S=function(){class e extends n{addBlog(e){var t,r;return r=`${e}.tumblr.com`,t=new this.model({id:r,name:e}),t.apiKey=P.get("consumer_key"),this.add(t),t.fetch().done(()=>this.save()),t}}return e.prototype.model=y,e}.call(this),v.reply("make-blog-post-collection",function(e){var t,r;return t=P.get("consumer_key"),(r=new x).apiKey=t,r.blogName=e,r}),v.reply("make-pix-collection",function(e){var t,r;return t=P.get("consumer_key"),(r=new x).state={firstPage:0,pageSize:1},r.apiKey=t,r.blogName=e,r}),N=new S({apiKey:P.get("consumer_key")}),v.reply("get-local-blogs",function(){return N}),R=r(191),L=u.a.Radio.channel("bumblr");var C,V,q,J=class extends h.MainController{set_header(e){return l()("#header").text(e)}start(){return this.setupLayoutIfNeeded(),this.set_header("Bumblr"),this.listBlogs()}default_view(){return this.start()}show_mainview(){var e;return e=new R.MainBumblrView,this.layout.showChildView("content",e),Object(d.default)()}showDashboard(){var e;return e=new R.BumblrDashboardView,this.layout.showChildView("content",e),Object(d.default)()}listBlogs(){return this.setupLayoutIfNeeded(),Promise.all([r.e(11),r.e(24)]).then((()=>{var e,t;return e=L.request("get-local-blogs"),t=new(r(222))({collection:e}),this.layout.showChildView("content",t)}).bind(null,r)).catch(r.oe)}viewBlog(e){return this.setupLayoutIfNeeded(),Promise.all([r.e(11),r.e(23)]).then((()=>{var t,n,o;return o=`${e}.tumblr.com`,n=L.request("make-blog-post-collection",o),t=r(221),n.fetch().done(()=>{var e;return e=new t({collection:n}),this.layout.showChildView("content",e),Object(d.default)()})}).bind(null,r)).catch(r.oe)}viewBlogPix(e){return this.setupLayoutIfNeeded(),Promise.all([r.e(11),r.e(23)]).then((()=>{var t,n,o;return o=`${e}.tumblr.com`,n=L.request("make-pix-collection",o),window.pix=n,t=r(220),n.getFirstPage().done(()=>{var e;return e=new t({collection:n}),this.layout.showChildView("content",e),Object(d.default)()})}).bind(null,r)).catch(r.oe)}addNewBlog(){return this.setupLayoutIfNeeded(),Promise.all([r.e(10),r.e(22)]).then((()=>{var e;return e=new(r(219)),this.layout.showChildView("content",e),Object(d.default)()}).bind(null,r)).catch(r.oe)}settingsPage(){return this.setupLayoutIfNeeded(),Promise.all([r.e(10),r.e(21)]).then((()=>{var e;return e=new(0,r(218).default)({model:L.request("get_app_settings")}),this.layout.showChildView("content",e),Object(d.default)()}).bind(null,r)).catch(r.oe)}};Backbone.Radio.channel("global"),C=Backbone.Radio.channel("bumblr"),q=function(){class e extends s.a.AppRouter{}return e.prototype.appRoutes={bumblr:"start","bumblr/settings":"settingsPage","bumblr/dashboard":"showDashboard","bumblr/listblogs":"listBlogs","bumblr/viewblog/:id":"viewBlog","bumblr/addblog":"addNewBlog","bumblr/viewpix/:id":"viewBlogPix"},e}.call(this),V=function(){class e extends a.a{onBeforeStart(){var e;return(e=C.request("get-local-blogs")).fetch(),e.isEmpty()&&["dutch-and-flemish-painters","gkar56","japanesesuburbia","8bitfuture","elfwud","hexeosis","pixel8or","necessary-disorder"].forEach(function(t){return e.addBlog(t)}),super.onBeforeStart(arguments)}}return e.prototype.Controller=J,e.prototype.Router=q,e.prototype.appletEntries=[{label:"Bumblr Menu",menu:[{label:"List Blogs",url:"#bumblr/listblogs",icon:".fa.fa-list"},{label:"Add Blog",url:"#bumblr/addblog",icon:".fa.fa-plus"},{label:"Settings",url:"#bumblr/settings",icon:".fa.fa-gear"}]}],e}.call(this);t.default=V},59:function(e,t,r){var n;window,n=function(e,t,r){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}({"./node_modules/webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},"./src/driver.coffee":
/*!***************************!*\
  !*** ./src/driver.coffee ***!
  \***************************/
/*! exports provided: LoveStore */function(e,t,r){"use strict";r.r(t);var n=r(/*! backbone */"backbone"),o=r.n(n),s=r(/*! ./sync */"./src/sync.coffee"),a=r(/*! ./store */"./src/store.coffee");r.d(t,"LoveStore",function(){return a.LoveStore});var i,l,c=r(/*! ./utils */"./src/utils.coffee");o.a.LoveStore=a.LoveStore,i=o.a.sync,l=function(e,t={}){var r,n;return r=t.ajaxSync,n=Object(c.getLoveStore)(e),!r&&n?s.sync:i},o.a.sync=function(e,t,r){return l(t,r).apply(this,[e,t,r])}},"./src/store.coffee":
/*!**************************!*\
  !*** ./src/store.coffee ***!
  \**************************/
/*! exports provided: LoveStore */function(e,t,r){"use strict";r.r(t),r.d(t,"LoveStore",function(){return i});var n=r(/*! underscore */"underscore"),o=r(/*! lovefield */"lovefield"),s=r.n(o),a=r(/*! ./utils */"./src/utils.coffee"),i=class{constructor(e,t=""){this.conn=e,this.name=t}_getTable(){return this.conn.getSchema().table(this.name)}create(e){var t,r,n;return n=this._getTable(),e.id||0===e.id||(e.id=Object(a.guid)(),e.set(e.idAttribute,e.id)),t=e.toJSON(),r=n.createRow(t),this.conn.insert().into(n).values([r]).exec()}update(e){var t,r,n;return n=this._getTable(),t=e.toJSON(),r=this.conn.update(n),Object.keys(t).forEach(function(e){return r=r.set(n[e],t[e])}),(r=r.where(n.id.eq(t.id))).exec()}find(e,t){var r,o,s;return s=this._getTable(),o=Object(n.result)(e,"idAttribute"),r=Object(n.result)(e,o),this.conn.select().from(s).where(s.id.eq(r)).exec().then(function(t){return e.set(t[0]),e})}findAll(e,t){var r,n,o;return o=this._getTable(),n=this.conn.select().from(o),t.data&&(r=[],Object.keys(t.data).forEach(function(e){var n;return n=o[e].eq(t.data[e]),r.push(n)}),n=r.length>1?n.where(s.a.op.and(r)):n.where(r[0])),n.exec().then(function(t){return e instanceof Backbone.Collection?e.set(t):e.set(t[0])})}destroy(e,t){var r;return r=this._getTable(),this.conn.delete().from(r).where(r.id.eq(e.id)).exec()}}},"./src/sync.coffee":
/*!*************************!*\
  !*** ./src/sync.coffee ***!
  \*************************/
/*! exports provided: sync */function(e,t,r){"use strict";r.r(t),r.d(t,"sync",function(){return i});var n=r(/*! backbone */"backbone"),o=r.n(n),s=r(/*! underscore */"underscore"),a=r(/*! ./utils */"./src/utils.coffee");var i=function(e,t,r={}){var n,o,i,l,c;c=Object(a.getLoveStore)(t),l=void 0;try{switch(e){case"read":i=Object(s.result)(t,"idAttribute"),l=Object(s.result)(t,i)?c.find(t,r):c.findAll(t,r);break;case"create":l=c.create(t,r);break;case"patch":case"update":l=c.update(t,r);break;case"delete":l=c.destroy(t,r)}}catch(e){o=22===(n=e).code?"Private browsing is unsupported":n.message}return l?(l.done=l.then,l.fail=l.catch,r.success&&r.success.call(t,l,r)):(o=o||"Record Not Found",r.error&&r.error.call(t,o,r)),r.complete&&r.complete.call(t,l),l}},"./src/utils.coffee":
/*!**************************!*\
  !*** ./src/utils.coffee ***!
  \**************************/
/*! exports provided: guid, getLoveConnection, getTableName, getWindow, getLoveStore */function(e,t,r){"use strict";r.r(t),function(e){r.d(t,"guid",function(){return s}),r.d(t,"getLoveConnection",function(){return a}),r.d(t,"getTableName",function(){return i}),r.d(t,"getWindow",function(){return l}),r.d(t,"getLoveStore",function(){return c});var n,o=r(/*! underscore */"underscore");n=function(){return(0|65536*(1+Math.random())).toString(16).substring(1)};var s=function(){return`${n()}${n()}-${n()}-${n()}-${n()}-${n()}${n()}${n()}`},a=function(e){return Object(o.result)(e,"loveConnection")||Object(o.result)(e.collection,"loveConnection")},i=function(e){return Object(o.result)(e,"tableName")||Object(o.result)(e.collection,"tableName")},l=function(){return Object(o.isUndefined)(window)?e:window},c=function(e){return Object(o.result)(e,"loveStore")||Object(o.result)(e.collection,"loveStore")}}.call(this,r(/*! ./../node_modules/webpack/buildin/global.js */"./node_modules/webpack/buildin/global.js"))},0:
/*!*********************************!*\
  !*** multi ./src/driver.coffee ***!
  \*********************************/
/*! no static exports found */function(e,t,r){e.exports=r(/*! ./src/driver.coffee */"./src/driver.coffee")},backbone:
/*!**************************************************************************************************!*\
  !*** external {"amd":"backbone","commonjs":"backbone","commonjs2":"backbone","root":"Backbone"} ***!
  \**************************************************************************************************/
/*! no static exports found */function(t,r){t.exports=e},lovefield:
/*!***********************************************************************************************!*\
  !*** external {"amd":"lovefield","commonjs":"lovefield","commonjs2":"lovefield","root":"lf"} ***!
  \***********************************************************************************************/
/*! no static exports found */function(e,r){e.exports=t},underscore:
/*!*************************************************************************************************!*\
  !*** external {"amd":"underscore","commonjs":"underscore","commonjs2":"underscore","root":"_"} ***!
  \*************************************************************************************************/
/*! no static exports found */function(e,t){e.exports=r}})},e.exports=n(r(2),r(1),r(7))}}]);
//# sourceMappingURL=9-1f38929893c107773b51.js.map