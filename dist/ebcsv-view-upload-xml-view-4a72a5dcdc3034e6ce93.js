(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{217:function(e,t,n){var r,i,a,u,s,l,o,c,d,p,f=function(e,t){if(!(e instanceof t))throw new Error("Bound instance method accessed before binding")};i=n(2),n(3),n(47),p=n(0),d=n(14).default,({make_field_input:o,make_field_select:c}=n(43)),i.Radio.channel("global"),u=i.Radio.channel("messages"),r=i.Radio.channel("ebcsv"),l=p.renderable(function(e){return p.article(".document-view.content",function(){return p.div(".body",function(){return p.div(".card",function(){return p.div(".card-header",function(){return p.text("Drop an xml file, or use the "),p.button(".sample-comics-button.btn.btn-default","Example data.")}),p.div(".card-body",function(){return p.div(".parse-btn.btn.btn-default",{style:"display:none"},function(){return p.text("Parse Dropped File")}),p.input(".xml-file-input.input",{type:"file"}),p.span(".parse-chosen-button.btn.btn-default",{style:"display:none"},function(){return p.text("Parse input file.")})})})})})}),s=function(){class e extends i.Model{fetch(e){return(e=e||{}).dataType="text",super.fetch(e)}parse(e,t){return{content:e}}}return e.prototype.url="/assets/documents/sample-comics.xml",e}.call(this),a=function(){class e extends i.Marionette.View{constructor(){super(...arguments),this.successfulParse=this.successfulParse.bind(this),this.xmlReaderOnLoad=this.xmlReaderOnLoad.bind(this)}file_input_clicked(e){return console.log("file_input_clicked",e),this.ui.file_input.val(null),this.ui.chosen_btn.hide()}file_input_changed(e){return console.log("file_input_changed",e),this.ui.chosen_btn.show()}handle_drop(e){var t;return e.preventDefault(),this.$el.css("border","0px"),t=e.originalEvent.dataTransfer.files[0],this.ui.status_msg.text(`File: ${t.name}`),this.droppedFile=t,this.ui.parse_btn.show()}handle_dragOver(e){return e.preventDefault(),e.stopPropagation()}handle_dragEnter(e){return e.stopPropagation(),e.preventDefault(),this.$el.css("border","2px dotted")}successfulParse(){return f(this,e),this.ui.status_msg.text("Parse Successful"),d("#ebcsv")}parse_chosen_xml(){var e,t;return this.ui.status_msg.text("Reading xml file..."),this.ui.file_input.val(),this.ui.file_input,e=this.ui.file_input[0].files[0],(t=new FileReader).onload=this.xmlReaderOnLoad,t.readAsText(e),this.ui.parse_btn.hide()}xmlReaderOnLoad(t){var n;return f(this,e),n=t.target.result,this.ui.status_msg.text("Parsing xml....."),r.request("parse-comics-xml",n,this.successfulParse)}parse_xml(){var e;return this.ui.status_msg.text("Reading xml file..."),(e=new FileReader).onload=this.xmlReaderOnLoad,e.readAsText(this.droppedFile),this.ui.parse_btn.hide()}parse_sample_xml(){var e,t;return t=(e=new s).fetch(),this.ui.status_msg.text("Retrieving xml...."),t.done(()=>{var t;return this.ui.status_msg.text("Parsing xml...."),t=e.get("content"),r.request("parse-comics-xml",t,this.successfulParse)}),t.fail(()=>(this.ui.status_msg.text("Something failed."),u.danger("Failed to parse sample comics")))}}return e.prototype.template=l,e.prototype.droppedFile=null,e.prototype.ui={status_msg:".card-header",file_input:".xml-file-input",parse_btn:".parse-btn",chosen_btn:".parse-chosen-button",sampleComicsBtn:".sample-comics-button"},e.prototype.events={dragover:"handle_dragOver",dragenter:"handle_dragEnter",drop:"handle_drop","click @ui.parse_btn":"parse_xml","click @ui.file_input":"file_input_clicked","change @ui.file_input":"file_input_changed","click @ui.chosen_btn":"parse_chosen_xml","click @ui.sampleComicsBtn":"parse_sample_xml"},e}.call(this),e.exports=a},43:function(e,t,n){"use strict";n.r(t),n.d(t,"form_group_input_div",function(){return r}),n.d(t,"make_field_input",function(){return a}),n.d(t,"make_field_textarea",function(){return s}),n.d(t,"make_field_select",function(){return u}),n.d(t,"make_login_form",function(){return l}),n.d(t,"login_form",function(){return i}),n.d(t,"name_content_form",function(){return o});var r,i,a,u,s,l,o,c=n(0),d=n.n(c),p=n(45);r=d.a.renderable(function(e){return d.a.div(".form-group",function(){var t,n,r;return d.a.label(".control-label",{for:e.input_id},e.label),r=`#${e.input_id}.form-control`,t=e.input_attributes,n=d.a.input,(null!=e?e.input_type:void 0)?(n=d.a[e.input_type])(r,t,function(){return d.a.text(null!=e?e.content:void 0)}):n(r,t)})}),a=function(e){return d.a.renderable(function(t){return r({input_id:`input_${e}`,label:Object(p.default)(e),input_attributes:{name:e,placeholder:e,value:t[e]}})})},s=function(e){return d.a.renderable(function(t){return r({input_id:`input_${e}`,input_type:"textarea",label:Object(p.default)(e),input_attributes:{name:e,placeholder:e},content:t[e]})})},u=function(e,t){return d.a.renderable(function(n){return d.a.div(".form-group",function(){return d.a.label(".control-label",{for:`select_${e}`}),Object(p.default)(e)}),d.a.select(".form-control",{name:`select_${e}`},function(){var r,i,a,u;for(u=[],r=0,i=t.length;r<i;r++)a=t[r],n[e]===a?u.push(d.a.option({selected:null,value:a},a)):u.push(d.a.option({value:a},a));return u})})},i=(l=function(e="/login",t="POST"){return d.a.renderable(function(n){return d.a.form({role:"form",method:t,action:e},function(){return r({input_id:"input_username",label:"User Name",input_attributes:{name:"username",placeholder:"User Name"}}),r({input_id:"input_password",label:"Password",input_attributes:{name:"password",type:"password",placeholder:"Type your password here...."}}),d.a.button(".btn.btn-secondary",{type:"submit"},"login")})})})(),o=d.a.renderable(function(e){return r({input_id:"input_name",label:"Name",input_attributes:{name:"name",placeholder:"Name"}}),r({input_id:"input_content",input_type:d.a.textarea,label:"Content",input_attributes:{name:"content",placeholder:"..."}}),d.a.input(".btn.btn-secondary.btn-sm",{type:"submit",value:"Add"})})}}]);
//# sourceMappingURL=ebcsv-view-upload-xml-view-4a72a5dcdc3034e6ce93.js.map